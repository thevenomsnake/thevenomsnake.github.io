<!DOCTYPE html>


  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">

<script type="text/javascript">var OriginTitile=document.title,st;document.addEventListener("visibilitychange",function(){document.hidden?(document.title="(/≧▽≦/)Aw, Snap!",clearTimeout(st)):(document.title="(ฅ>ω<*ฅ) Fixed~"+OriginTitile,st=setTimeout(function(){document.title=OriginTitile},3e3))})</script>



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-bounce.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Swift,Algorithm," />










<meta name="description" content="just several sorting algorithms. Expand reading: Wikipedia">
<meta name="keywords" content="Swift,Algorithm">
<meta property="og:type" content="article">
<meta property="og:title" content="Several sorting algorithms">
<meta property="og:url" content="http://www.perphet.com/2019/06/Several-sorting-algorithms/index.html">
<meta property="og:site_name" content="Tuski&#39;s Blog">
<meta property="og:description" content="just several sorting algorithms. Expand reading: Wikipedia">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://s2.ax1x.com/2019/06/19/VXtn9x.jpg">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/insertionSort.gif">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/selectionSort.gif">
<meta property="og:image" content="https://s2.ax1x.com/2019/06/19/VXlio6.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/quickSort.gif">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Quicksort/Images/Example.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/heapSort.gif">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/Sorting_heapsort_anim.gif">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Heap%20Sort/Images/MaxHeap.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/countingSort.gif">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/radixSort.gif">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Graph.png">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/TopologicalSort.png">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/InvalidSort.png">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Algorithms.png">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Example.png">
<meta property="og:image" content="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/GraphResult.png">
<meta property="og:image" content="https://www.runoob.com/wp-content/uploads/2019/03/bubbleSort.gif">
<meta property="og:updated_time" content="2019-06-19T12:37:54.713Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Several sorting algorithms">
<meta name="twitter:description" content="just several sorting algorithms. Expand reading: Wikipedia">
<meta name="twitter:image" content="https://s2.ax1x.com/2019/06/19/VXtn9x.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":true},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://www.perphet.com/2019/06/Several-sorting-algorithms/"/>



<link rel="stylesheet" href="../live2d/css/live2d.css" />


  <title>Several sorting algorithms | Tuski's Blog</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner">
<div class="site-brand-wrapper">
  <div class="site-meta ">
    

   
    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Tuski's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">I code my life</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-music">
          <a href="/music/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-music"></i> <br />
            
            Music
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.perphet.com/2019/06/Several-sorting-algorithms/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Tuski">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Tuski's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Several sorting algorithms</h1>
        

        <div class="post-meta">

          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-06-18T15:02:42+08:00">
                2019-06-18
              </time>
            

            

            
          </span>

          

          
            
            <!--noindex-->
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2019/06/Several-sorting-algorithms/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count hc-comment-count" data-xid="2019/06/Several-sorting-algorithms/" itemprop="commentsCount"></span>
                </a>
              </span>
              <!--/noindex-->
            
          

          
          
             <span id="/2019/06/Several-sorting-algorithms/" class="leancloud_visitors" data-flag-title="Several sorting algorithms">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">Visitors&#58;</span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  14,059
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  88
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <script src="/assets/js/APlayer.min.js"> </script><script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=default"></script>



<blockquote class="blockquote-center">just several sorting algorithms. Expand reading: Wikipedia<div align="center"> <img src="https://s2.ax1x.com/2019/06/19/VXtn9x.jpg" alt="zan"> </div></blockquote>

<a id="more"></a>
<h1 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h1><h2 id="Classification"><a href="#Classification" class="headerlink" title="Classification"></a>Classification</h2><p>Algorithms usually can be divided into two categories:</p>
<ul>
<li><strong>Comparison Sorting:</strong> The relative order between elements is determined by comparison, because its time complexity cannot break <strong>O(nlogn)</strong>, so it is also called nonlinear time comparison sorting.</li>
<li><strong>Non-comparative Sorting: </strong>The relative order between elements is not determined by comparison, so it is possible to break through the lower bound of time based on comparison sorting and run in linear time, so it is also called linear non-comparative sorting.</li>
</ul>
<h2 id="Algorithm-complexity"><a href="#Algorithm-complexity" class="headerlink" title="Algorithm complexity"></a>Algorithm complexity</h2><table>
<thead>
<tr>
<th>Sorting</th>
<th>TC(avg)</th>
<th>TC(bad)</th>
<th>TC(good)</th>
<th>SC</th>
<th>Stability</th>
</tr>
</thead>
<tbody>
<tr>
<td>Insertion Sort</td>
<td>$$O(n^2)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(n)$$</td>
<td>$$O(1)$$</td>
<td>T</td>
</tr>
<tr>
<td>Shell Sort</td>
<td>$$O(n^{1.3})$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(n)$$</td>
<td>$$O(1)$$</td>
<td>F</td>
</tr>
<tr>
<td>Selection Sort</td>
<td>$$O(n^2)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(1)$$</td>
<td>F</td>
</tr>
<tr>
<td>Heap Sort</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O(1)$$</td>
<td>T</td>
</tr>
<tr>
<td>Bubble Sort</td>
<td>$$O(n^2)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(n)$$</td>
<td>$$O(1)$$</td>
<td>T</td>
</tr>
<tr>
<td>Quicksort</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>F</td>
</tr>
<tr>
<td>Merge Sort</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O({nlog}_2n)$$</td>
<td>$$O(n)$$</td>
<td>T</td>
</tr>
<tr>
<td>Counting Sort*</td>
<td>$$O(n+k)$$</td>
<td>$$O(n+k)$$</td>
<td>$$O(n+k)$$</td>
<td>$$O(n+k)$$</td>
<td>T</td>
</tr>
<tr>
<td>Bucket Sort*</td>
<td>$$O(n+k)$$</td>
<td>$$O(n^2)$$</td>
<td>$$O(n)$$</td>
<td>$$O(n+k)$$</td>
<td>T</td>
</tr>
<tr>
<td>Radix Sort</td>
<td>$$O(n+k)$$</td>
<td>$$O(n*k)$$</td>
<td>$$O(n*k)$$</td>
<td>$$O(n*k)$$</td>
<td>T</td>
</tr>
</tbody>
</table>
<p>It’s fun to see how sorting algorithms work, but in practice you’ll almost never have to provide your own sorting routines. </p>
<h1 id="Basic-sorts"><a href="#Basic-sorts" class="headerlink" title="Basic sorts:"></a>Basic sorts:</h1><h2 id="Insertion-Sort"><a href="#Insertion-Sort" class="headerlink" title="Insertion Sort"></a>Insertion Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/insertionSort.gif" alt="insertionSort"></p>
<p>Goal: Sort an array from low to high (or high to low).</p>
<p>You are given an array of numbers and need to put them in the right order. The insertion sort algorithm works as follows:</p>
<ul>
<li>Put the numbers on a pile. This pile is unsorted.</li>
<li>Pick a number from the pile. It doesn’t really matter which one you pick, but it’s easiest to pick from the top of the pile.</li>
<li>Insert this number into a new array.</li>
<li>Pick the next number from the unsorted pile and also insert that into the new array. It either goes before or after the first number you picked, so that now these two numbers are sorted.</li>
<li>Again, pick the next number from the pile and insert it into the array in the proper sorted position.</li>
<li>Keep doing this until there are no more numbers on the pile. You end up with an empty pile and an array that is sorted.</li>
</ul>
<p>That’s why this is called an “insertion” sort, because you take a number from the pile and insert it in the array in its proper sorted position.</p>
<h3 id="An-example"><a href="#An-example" class="headerlink" title="An example"></a>An example</h3><p>Let’s say the numbers to sort are <code>[ 8, 3, 5, 4, 6 ]</code>. This is our unsorted pile.</p>
<p>Pick the first number, <code>8</code>, and insert it into the new array. There is nothing in that array yet, so that’s easy. The sorted array is now <code>[ 8 ]</code> and the pile is <code>[ 3, 5, 4, 6 ]</code>.</p>
<p>Pick the next number from the pile, <code>3</code>, and insert it into the sorted array. It should go before the <code>8</code>, so the sorted array is now <code>[ 3, 8 ]</code> and the pile is reduced to <code>[ 5, 4, 6 ]</code>.</p>
<p>Pick the next number from the pile, <code>5</code>, and insert it into the sorted array. It goes in between the <code>3</code> and <code>8</code>. The sorted array is <code>[ 3, 5, 8 ]</code> and the pile is <code>[ 4, 6 ]</code>.</p>
<p>Repeat this process until the pile is empty.</p>
<h3 id="In-place-sort"><a href="#In-place-sort" class="headerlink" title="In-place sort"></a>In-place sort</h3><p>The above explanation makes it seem like you need two arrays: one for the unsorted pile and one that contains the numbers in sorted order.</p>
<p>But you can perform the insertion sort <em>in-place</em>, without having to create a separate array. You just keep track of which part of the array is sorted already and which part is the unsorted pile.</p>
<p>Initially, the array is <code>[ 8, 3, 5, 4, 6 ]</code>. The <code>|</code> bar shows where the sorted portion ends and the pile begins:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[| 8, 3, 5, 4, 6 ]</div></pre></td></tr></table></figure>
<p>This shows that the sorted portion is empty and the pile starts at <code>8</code>.</p>
<p>After processing the first number, we have:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 8 | 3, 5, 4, 6 ]</div></pre></td></tr></table></figure>
<p>The sorted portion is <code>[ 8 ]</code> and the pile is <code>[ 3, 5, 4, 6 ]</code>. The <code>|</code> bar has shifted one position to the right.</p>
<p>This is how the content of the array changes during the sort:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">[| 8, 3, 5, 4, 6 ]</div><div class="line">[ 8 | 3, 5, 4, 6 ]</div><div class="line">[ 3, 8 | 5, 4, 6 ]</div><div class="line">[ 3, 5, 8 | 4, 6 ]</div><div class="line">[ 3, 4, 5, 8 | 6 ]</div><div class="line">[ 3, 4, 5, 6, 8 |]</div></pre></td></tr></table></figure>
<p>In each step, the <code>|</code> bar moves up one position. As you can see, the beginning of the array up to the <code>|</code> is always sorted. The pile shrinks by one and the sorted portion grows by one, until the pile is empty and there are no more unsorted numbers left.</p>
<h3 id="How-to-insert"><a href="#How-to-insert" class="headerlink" title="How to insert"></a>How to insert</h3><p>At each step you pick the top-most number from the unsorted pile and insert it into the sorted portion of the array. You must put that number in the proper place so that the beginning of the array remains sorted. How does that work?</p>
<p>Let’s say we’ve already done the first few elements and the array looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 3, 5, 8 | 4, 6 ]</div></pre></td></tr></table></figure>
<p>The next number to sort is <code>4</code>. We need to insert that into the sorted portion <code>[ 3, 5, 8 ]</code> somewhere.</p>
<p>Here’s one way to do this: Look at the previous element, <code>8</code>.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 3, 5, 8, 4 | 6 ]</div><div class="line">        ^</div></pre></td></tr></table></figure>
<p>Is this greater than <code>4</code>? Yes it is, so the <code>4</code> should come before the <code>8</code>. We swap these two numbers to get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ 3, 5, 4, 8 | 6 ]</div><div class="line">        &lt;--&gt;</div><div class="line">       swapped</div></pre></td></tr></table></figure>
<p>We’re not done yet. The new previous element, <code>5</code>, is also greater than <code>4</code>. We also swap these two numbers:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ 3, 4, 5, 8 | 6 ]</div><div class="line">     &lt;--&gt;</div><div class="line">    swapped</div></pre></td></tr></table></figure>
<p>Again, look at the previous element. Is <code>3</code> greater than <code>4</code>? No, it is not. That means we’re done with number <code>4</code>. The beginning of the array is sorted again.</p>
<p>This was a description of the inner loop of the insertion sort algorithm, which you’ll see in the next section. It inserts the number from the top of the pile into the sorted portion by swapping numbers.</p>
<h3 id="The-code"><a href="#The-code" class="headerlink" title="The code"></a>The code</h3><p>Here is an implementation of insertion sort in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertionSort</span><span class="params">(<span class="number">_</span> array: [Int])</span></span> -&gt; [<span class="type">Int</span>] &#123;</div><div class="line">    <span class="keyword">var</span> a = array			 <span class="comment">// 1</span></div><div class="line">    <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">1</span>..&lt;a.<span class="built_in">count</span> &#123;		 <span class="comment">// 2</span></div><div class="line">        <span class="keyword">var</span> y = x</div><div class="line">        <span class="keyword">while</span> y &gt; <span class="number">0</span> &amp;&amp; a[y] &lt; a[y - <span class="number">1</span>] &#123; <span class="comment">// 3</span></div><div class="line">            a.swapAt(y - <span class="number">1</span>, y)</div><div class="line">            y -= <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> a</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Put this code in a playground and test it like so:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> list = [ <span class="number">10</span>, -<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">26</span> ]</div><div class="line"><span class="built_in">insertionSort</span>(list)</div></pre></td></tr></table></figure>
<p>Here is how the code works.</p>
<ol>
<li>Make a copy of the array. This is necessary because we cannot modify the contents of the <code>array</code> parameter directly. Like Swift’s own <code>sort()</code>, the <code>insertionSort()</code> function will return a sorted <em>copy</em> of the original array.</li>
<li>There are two loops inside this function. The outer loop looks at each of the elements in the array in turn; this is what picks the top-most number from the pile. The variable <code>x</code> is the index of where the sorted portion ends and the pile begins (the position of the <code>|</code> bar). Remember, at any given moment the beginning of the array – from index 0 up to <code>x</code> – is always sorted. The rest, from index <code>x</code> until the last element, is the unsorted pile.</li>
<li>The inner loop looks at the element at position <code>x</code>. This is the number at the top of the pile, and it may be smaller than any of the previous elements. The inner loop steps backwards through the sorted array; every time it finds a previous number that is larger, it swaps them. When the inner loop completes, the beginning of the array is sorted again, and the sorted portion has grown by one element.</li>
</ol>
<blockquote>
<p><strong>Note:</strong> The outer loop starts at index 1, not 0. Moving the very first element from the pile to the sorted portion doesn’t actually change anything, so we might as well skip it.</p>
</blockquote>
<h3 id="No-more-swaps"><a href="#No-more-swaps" class="headerlink" title="No more swaps"></a>No more swaps</h3><p>The above version of insertion sort works fine, but it can be made a tiny bit faster by removing the call to <code>swap()</code>.</p>
<p>You’ve seen that we swap numbers to move the next element into its sorted position:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[ 3, 5, 8, 4 | 6 ]</div><div class="line">        &lt;--&gt;</div><div class="line">        swap</div><div class="line">        </div><div class="line">[ 3, 5, 4, 8 | 6 ]</div><div class="line">     &lt;--&gt;</div><div class="line">     swap</div></pre></td></tr></table></figure>
<p>Instead of swapping with each of the previous elements, we can just shift all those elements one position to the right, and then copy the new number into the right position.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">[ 3, 5, 8, 4 | 6 ]   remember 4</div><div class="line">           *</div><div class="line"></div><div class="line">[ 3, 5, 8, 8 | 6 ]   shift 8 to the right</div><div class="line">        ---&gt;</div><div class="line">        </div><div class="line">[ 3, 5, 5, 8 | 6 ]   shift 5 to the right</div><div class="line">     ---&gt;</div><div class="line">     </div><div class="line">[ 3, 4, 5, 8 | 6 ]   copy 4 into place</div><div class="line">     *</div></pre></td></tr></table></figure>
<p>In code that looks like this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertionSort</span><span class="params">(<span class="number">_</span> array: [Int])</span></span> -&gt; [<span class="type">Int</span>] &#123;</div><div class="line">  <span class="keyword">var</span> a = array</div><div class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">1</span>..&lt;a.<span class="built_in">count</span> &#123;</div><div class="line">    <span class="keyword">var</span> y = x</div><div class="line">    <span class="keyword">let</span> temp = a[y]</div><div class="line">    <span class="keyword">while</span> y &gt; <span class="number">0</span> &amp;&amp; temp &lt; a[y - <span class="number">1</span>] &#123;</div><div class="line">      a[y] = a[y - <span class="number">1</span>]                <span class="comment">// 1</span></div><div class="line">      y -= <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">    a[y] = temp                      <span class="comment">// 2</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> a</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>The line at <code>//1</code> is what shifts up the previous elements by one position. At the end of the inner loop, <code>y</code> is the destination index for the new number in the sorted portion, and the line at <code>//2</code> copies this number into place.</p>
<h3 id="Making-it-generic"><a href="#Making-it-generic" class="headerlink" title="Making it generic"></a>Making it generic</h3><p>It would be nice to sort other things than just numbers. We can make the datatype of the array generic and use a user-supplied function (or closure) to perform the less-than comparison. This only requires two changes to the code.</p>
<p>The function signature becomes:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">insertionSort</span>&lt;T&gt;<span class="params">(<span class="number">_</span> array: [T], <span class="number">_</span> isOrderedBefore: <span class="params">(T, T)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">T</span>] &#123;</div></pre></td></tr></table></figure>
<p>The array has type <code>[T]</code> where <code>T</code> is the placeholder type for the generics. Now <code>insertionSort()</code> will accept any kind of array, whether it contains numbers, strings, or something else.</p>
<p>The new parameter <code>isOrderedBefore: (T, T) -&gt; Bool</code> is a function that takes two <code>T</code> objects and returns true if the first object comes before the second, and false if the second object should come before the first. This is exactly what Swift’s built-in <code>sort()</code> function does.</p>
<p>The only other change is in the inner loop, which now becomes:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">while</span> y &gt; <span class="number">0</span> &amp;&amp; isOrderedBefore(temp, a[y - <span class="number">1</span>]) &#123;</div></pre></td></tr></table></figure>
<p>Instead of writing <code>temp &lt; a[y - 1]</code>, we call the <code>isOrderedBefore()</code> function. It does the exact same thing, except we can now compare any kind of object, not just numbers.</p>
<p>To test this in a playground, do:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> numbers = [ <span class="number">10</span>, -<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">26</span> ]</div><div class="line"><span class="built_in">insertionSort</span>(numbers, &lt;)</div><div class="line"><span class="built_in">insertionSort</span>(numbers, &gt;)</div></pre></td></tr></table></figure>
<p>The <code>&lt;</code> and <code>&gt;</code> determine the sort order, low-to-high and high-to-low, respectively.</p>
<p>Of course, you can also sort other things such as strings,</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> strings = [ <span class="string">"b"</span>, <span class="string">"a"</span>, <span class="string">"d"</span>, <span class="string">"c"</span>, <span class="string">"e"</span> ]</div><div class="line"><span class="built_in">insertionSort</span>(strings, &lt;)</div></pre></td></tr></table></figure>
<p>or even more complex objects:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> objects = [ obj1, obj2, obj3, ... ]</div><div class="line"><span class="built_in">insertionSort</span>(objects) &#123; $<span class="number">0</span>.priority &lt; $<span class="number">1</span>.priority &#125;</div></pre></td></tr></table></figure>
<p>The closure tells <code>insertionSort()</code> to sort on the <code>priority</code> property of the objects.</p>
<p>Insertion sort is a <em>stable</em> sort. A sort is stable when elements that have identical sort keys remain in the same relative order after sorting. This is not important for simple values such as numbers or strings, but it is important when sorting more complex objects. In the example above, if two objects have the same <code>priority</code>, regardless of the values of their other properties, those two objects don’t get swapped around.</p>
<h3 id="Performance"><a href="#Performance" class="headerlink" title="Performance"></a>Performance</h3><p>Insertion sort is really fast if the array is already sorted. That sounds obvious, but this is not true for all search algorithms. In practice, a lot of data will already be largely – if not entirely – sorted and insertion sort works quite well in that case.</p>
<p>The worst-case and average case performance of insertion sort is <strong>O(n^2)</strong>. That’s because there are two nested loops in this function. Other sort algorithms, such as quicksort and merge sort, have <strong>O(n log n)</strong> performance, which is faster on large inputs.</p>
<p>Insertion sort is actually very fast for sorting small arrays. Some standard libraries have sort functions that switch from a quicksort to insertion sort when the partition size is 10 or less.</p>
<p>I did a quick test comparing our <code>insertionSort()</code> with Swift’s built-in <code>sort()</code>. On arrays of about 100 items or so, the difference in speed is tiny. However, as your input becomes larger, <strong>O(n^2)</strong> quickly starts to perform a lot worse than <strong>O(n log n)</strong> and insertion sort just can’t keep up.</p>
<h2 id="Selection-Sort"><a href="#Selection-Sort" class="headerlink" title="Selection Sort"></a>Selection Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/selectionSort.gif" alt="selectionSort"></p>
<p>Goal: To sort an array from low to high (or high to low).</p>
<p>You are given an array of numbers and need to put them in the right order. The selection sort algorithm divides the array into two parts: the beginning of the array is sorted, while the rest of the array consists of the numbers that still remain to be sorted.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ ...sorted numbers... | ...unsorted numbers... ]</div></pre></td></tr></table></figure>
<p>This is similar to <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Insertion%20Sort" target="_blank" rel="external">insertion sort</a>, but the difference is in how new numbers are added to the sorted portion.</p>
<p>It works as follows:</p>
<ul>
<li>Find the lowest number in the array. You must start at index 0, loop through all the numbers in the array, and keep track of what the lowest number is.</li>
<li>Swap the lowest number with the number at index 0. Now, the sorted portion consists of just the number at index 0.</li>
<li>Go to index 1.</li>
<li>Find the lowest number in the rest of the array. This time you start looking from index 1. Again you loop until the end of the array and keep track of the lowest number you come across.</li>
<li>Swap the lowest number with the number at index 1. Now, the sorted portion contains two numbers and extends from index 0 to index 1.</li>
<li>Go to index 2.</li>
<li>Find the lowest number in the rest of the array, starting from index 2, and swap it with the one at index 2. Now, the array is sorted from index 0 to 2; this range contains the three lowest numbers in the array.</li>
<li>And continue until no numbers remain to be sorted.</li>
</ul>
<p>It is called a “selection” sort because at every step you search through the rest of the array to select the next lowest number.</p>
<h3 id="An-example-1"><a href="#An-example-1" class="headerlink" title="An example"></a>An example</h3><p>Suppose the numbers to sort are <code>[ 5, 8, 3, 4, 6 ]</code>. We also keep track of where the sorted portion of the array ends, denoted by the <code>|</code> symbol.</p>
<p>Initially, the sorted portion is empty:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[| 5, 8, 3, 4, 6 ]</div></pre></td></tr></table></figure>
<p>Now we find the lowest number in the array. We do that by scanning through the array from left to right, starting at the <code>|</code>bar. We find the number <code>3</code>.</p>
<p>To put this number into the sorted position, we swap it with the number next to the <code>|</code>, which is <code>5</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 3 | 8, 5, 4, 6 ]</div><div class="line">  *      *</div></pre></td></tr></table></figure>
<p>The sorted portion is now <code>[ 3 ]</code> and the rest is <code>[ 8, 5, 4, 6 ]</code>.</p>
<p>Again, we look for the lowest number, starting from the <code>|</code> bar. We find <code>4</code> and swap it with <code>8</code> to get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 3, 4 | 5, 8, 6 ]</div><div class="line">     *      *</div></pre></td></tr></table></figure>
<p>With every step, the <code>|</code> bar moves one position to the right. We again look through the rest of the array and find <code>5</code> as the lowest number. There is no need to swap <code>5</code> with itself, and we simply move forward:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 3, 4, 5 | 8, 6 ]</div><div class="line">        *</div></pre></td></tr></table></figure>
<p>This process repeats until the array is sorted. Note that everything to the left of the <code>|</code> bar is always in sorted order and always contains the lowest numbers in the array. Finally, we end up with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 3, 4, 5, 6, 8 |]</div></pre></td></tr></table></figure>
<p>The selection sort is an <em>in-place</em> sort because everything happens in the same array without using additional memory. You can also implement this as a <em>stable</em> sort so that identical elements do not get swapped around relative to each other (note that the version given below is not stable).</p>
<h3 id="The-code-1"><a href="#The-code-1" class="headerlink" title="The code"></a>The code</h3><p>Here is an implementation of selection sort in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">selectionSort</span><span class="params">(<span class="number">_</span> array: [Int])</span></span> -&gt; [<span class="type">Int</span>] &#123;</div><div class="line">  <span class="keyword">guard</span> array.<span class="built_in">count</span> &gt; <span class="number">1</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> array &#125;  <span class="comment">// 1</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> a = array                    <span class="comment">// 2</span></div><div class="line"></div><div class="line">  <span class="keyword">for</span> x <span class="keyword">in</span> <span class="number">0</span> ..&lt; a.<span class="built_in">count</span> - <span class="number">1</span> &#123;     <span class="comment">// 3</span></div><div class="line"></div><div class="line">    <span class="keyword">var</span> lowest = x</div><div class="line">    <span class="keyword">for</span> y <span class="keyword">in</span> x + <span class="number">1</span> ..&lt; a.<span class="built_in">count</span> &#123;   <span class="comment">// 4</span></div><div class="line">      <span class="keyword">if</span> a[y] &lt; a[lowest] &#123;</div><div class="line">        lowest = y</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">if</span> x != lowest &#123;               <span class="comment">// 5</span></div><div class="line">      a.swapAt(x, lowest)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> a</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Put this code in a playground and test it like so:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> list = [ <span class="number">10</span>, -<span class="number">1</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">27</span>, <span class="number">8</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">3</span>, <span class="number">0</span>, <span class="number">26</span> ]</div><div class="line">selectionSort(list)</div></pre></td></tr></table></figure>
<p>A step-by-step explanation of how the code works:</p>
<ol>
<li>If the array is empty or only contains a single element, then there is no need to sort.</li>
<li>Make a copy of the array. This is necessary because we cannot modify the contents of the <code>array</code> parameter directly in Swift. Like the Swift’s <code>sort()</code> function, the <code>selectionSort()</code> function will return a sorted <em>copy</em> of the original array.</li>
<li>There are two loops inside this function. The outer loop looks at each of the elements in the array in turn; this is what moves the <code>|</code> bar forward.</li>
<li>This is the inner loop. It finds the lowest number in the rest of the array.</li>
<li>Swap the lowest number with the current array index. The <code>if</code> check is necessary because you can’t <code>swap()</code> an element with itself in Swift.</li>
</ol>
<p>In summary: For each element of the array, the selection sort swaps positions with the lowest value from the rest of the array. As a result, the array gets sorted from the left to the right. (You can also do it right-to-left, in which case you always look for the largest number in the array. Give that a try!)</p>
<blockquote>
<p><strong>Note:</strong> The outer loop ends at index <code>a.count - 2</code>. The very last element will automatically be in the correct position because at that point there are no other smaller elements left.</p>
</blockquote>
<p>The source file <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Selection%20Sort/SelectionSort.swift" target="_blank" rel="external">SelectionSort.swift</a> has a version of this function that uses generics, so you can also use it to sort strings and other data types.</p>
<h3 id="Performance-1"><a href="#Performance-1" class="headerlink" title="Performance"></a>Performance</h3><p>The selection sort is easy to understand but it performs slow as <strong>O(n^2)</strong>. It is worse than <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Insertion%20Sort" target="_blank" rel="external">insertion sort</a> but better than <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Bubble%20Sort" target="_blank" rel="external">bubble sort</a>. Finding the lowest element in the rest of the array is slow, especially since the inner loop will be performed repeatedly.</p>
<p>The <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Heap%20Sort" target="_blank" rel="external">Heap sort</a> uses the same principle as selection sort but has a fast method for finding the minimum value in the rest of the array. The heap sort’ performance is <strong>O(n log n)</strong>.</p>
<h2 id="Shell-Sort"><a href="#Shell-Sort" class="headerlink" title="Shell Sort"></a>Shell Sort</h2><p><img src="https://s2.ax1x.com/2019/06/19/VXlio6.png" alt="shell"></p>
<p>Shell sort is based on <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Insertion%20Sort" target="_blank" rel="external">insertion sort</a> as a general way to improve its performance, by breaking the original list into smaller sublists which are then individually sorted using insertion sort.</p>
<p><a href="https://www.youtube.com/watch?v=CmPA7zE8mx0" target="_blank" rel="external">There is a nice video created at Sapientia University</a> which shows the process as a Hungarian folk dance.</p>
<h3 id="How-it-works"><a href="#How-it-works" class="headerlink" title="How it works"></a>How it works</h3><p>Instead of comparing elements that are side-by-side and swapping them if they are out of order, the way insertion sort does it, the shell sort algorithm compares elements that are far apart.</p>
<p>The distance between elements is known as the <em>gap</em>. If the elements being compared are in the wrong order, they are swapped across the gap. This eliminates many in-between copies that are common with insertion sort.</p>
<p>The idea is that by moving the elements over large gaps, the array becomes partially sorted quite quickly. This makes later passes faster because they don’t have to swap so many items anymore.</p>
<p>Once a pass has been completed, the gap is made smaller and a new pass starts. This repeats until the gap has size 1, at which point the algorithm functions just like insertion sort. But since the data is already fairly well sorted by then, the final pass can be very quick.</p>
<h3 id="An-example-2"><a href="#An-example-2" class="headerlink" title="An example"></a>An example</h3><p>Suppose we want to sort the array <code>[64, 20, 50, 33, 72, 10, 23, -1, 4]</code> using shell sort.</p>
<p>We start by dividing the length of the array by 2:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n = floor(9/2) = 4</div></pre></td></tr></table></figure>
<p>This is the gap size.</p>
<p>We create <code>n</code> sublists. In each sublist, the items are spaced apart by a gap of size <code>n</code>. In our example, we need to make four of these sublists. The sublists are sorted by the <code>insertionSort()</code> function.</p>
<p>That may not have made a whole lot of sense, so let’s take a closer look at what happens.</p>
<p>The first pass is as follows. We have <code>n = 4</code>, so we make four sublists:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">sublist 0:  [ 64, xx, xx, xx, 72, xx, xx, xx, 4  ]</div><div class="line">sublist 1:  [ xx, 20, xx, xx, xx, 10, xx, xx, xx ]</div><div class="line">sublist 2:  [ xx, xx, 50, xx, xx, xx, 23, xx, xx ]</div><div class="line">sublist 3:  [ xx, xx, xx, 33, xx, xx, xx, -1, xx ]</div></pre></td></tr></table></figure>
<p>As you can see, each sublist contains only every 4th item from the original array. The items that are not in a sublist are marked with <code>xx</code>. So the first sublist is <code>[ 64, 72, 4 ]</code> and the second is <code>[ 20, 10 ]</code>, and so on. The reason we use this “gap” is so that we don’t have to actually make new arrays. Instead, we interleave them in the original array.</p>
<p>We now call <code>insertionSort()</code> once on each sublist.</p>
<p>This particular version of <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Insertion%20Sort" target="_blank" rel="external">insertion sort</a> sorts from the back to the front. Each item in the sublist is compared against the others. If they’re in the wrong order, the value is swapped and travels all the way down until we reach the start of the sublist.</p>
<p>So for sublist 0, we swap <code>4</code> with <code>72</code>, then swap <code>4</code> with <code>64</code>. After sorting, this sublist looks like:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">sublist 0:  [ 4, xx, xx, xx, 64, xx, xx, xx, 72 ]</div></pre></td></tr></table></figure>
<p>The other three sublists after sorting:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">sublist 1:  [ xx, 10, xx, xx, xx, 20, xx, xx, xx ]</div><div class="line">sublist 2:  [ xx, xx, 23, xx, xx, xx, 50, xx, xx ]</div><div class="line">sublist 3:  [ xx, xx, xx, -1, xx, xx, xx, 33, xx ]</div></pre></td></tr></table></figure>
<p>The total array looks like this now:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 4, 10, 23, -1, 64, 20, 50, 33, 72 ]</div></pre></td></tr></table></figure>
<p>It’s not entirely sorted yet but it’s more sorted than before. This completes the first pass.</p>
<p>In the second pass, we divide the gap size by two:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n = floor(4/2) = 2</div></pre></td></tr></table></figure>
<p>That means we now create only two sublists:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sublist 0:  [  4, xx, 23, xx, 64, xx, 50, xx, 72 ]</div><div class="line">sublist 1:  [ xx, 10, xx, -1, xx, 20, xx, 33, xx ]</div></pre></td></tr></table></figure>
<p>Each sublist contains every 2nd item. Again, we call <code>insertionSort()</code> to sort these sublists. The result is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">sublist 0:  [  4, xx, 23, xx, 50, xx, 64, xx, 72 ]</div><div class="line">sublist 1:  [ xx, -1, xx, 10, xx, 20, xx, 33, xx ]</div></pre></td></tr></table></figure>
<p>Note that in each list only two elements were out of place. So the insertion sort is really fast. That’s because we already sorted the array a little in the first pass.</p>
<p>The total array looks like this now:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 4, -1, 23, 10, 50, 20, 64, 33, 72 ]</div></pre></td></tr></table></figure>
<p>This completes the second pass. The gap size of the final pass is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">n = floor(2/2) = 1</div></pre></td></tr></table></figure>
<p>A gap size of 1 means we only have a single sublist, the array itself, and once again we call <code>insertionSort()</code> to sort it. The final sorted array is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 4, 10, 20, 23, 33, 50, 64, 72 ]</div></pre></td></tr></table></figure>
<p>The performance of shell sort is <strong>O(n^2)</strong> in most cases or <strong>O(n log n)</strong> if you get lucky. This algorithm produces an unstable sort; it may change the relative order of elements with equal values.</p>
<h3 id="The-gap-sequence"><a href="#The-gap-sequence" class="headerlink" title="The gap sequence"></a>The gap sequence</h3><p>The “gap sequence” determines the initial size of the gap and how it is made smaller with each iteration. A good gap sequence is important for shell sort to perform well.</p>
<p>The gap sequence in this implementation is the one from Shell’s original version: the initial value is half the array size and then it is divided by 2 each time. There are other ways to calculate the gap sequence.</p>
<h3 id="Just-for-fun…"><a href="#Just-for-fun…" class="headerlink" title="Just for fun…"></a>Just for fun…</h3><p>This is an old Commodore 64 BASIC version of shell sort that Matthijs used a long time ago and ported to pretty much every programming language he ever used:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">61200 REM S is the array to be sorted</div><div class="line">61205 REM AS is the number of elements in S</div><div class="line">61210 W1=AS</div><div class="line">61220 IF W1&lt;=0 THEN 61310</div><div class="line">61230 W1=INT(W1/2): W2=AS-W1</div><div class="line">61240 V=0</div><div class="line">61250 FOR N1=0 TO W2-1</div><div class="line">61260 W3=N1+W1</div><div class="line">61270 IF S(N1)&gt;S(W3) THEN SH=S(N1): S(N1)=S(W3): S(W3)=SH: V=1</div><div class="line">61280 NEXT N1</div><div class="line">61290 IF V&gt;0 THEN 61240</div><div class="line">61300 GOTO 61220</div><div class="line">61310 RETURN</div></pre></td></tr></table></figure>
<h3 id="The-Code"><a href="#The-Code" class="headerlink" title="The Code:"></a>The Code:</h3><p>Here is an implementation of Shell Sort in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> arr = [<span class="number">64</span>, <span class="number">20</span>, <span class="number">50</span>, <span class="number">33</span>, <span class="number">72</span>, <span class="number">10</span>, <span class="number">23</span>, -<span class="number">1</span>, <span class="number">4</span>, <span class="number">5</span>]</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">shellSort</span><span class="params">(<span class="number">_</span> list: <span class="keyword">inout</span> [Int])</span></span> &#123;</div><div class="line">    <span class="keyword">var</span> sublistCount = list.<span class="built_in">count</span> / <span class="number">2</span></div><div class="line">    <span class="keyword">while</span> sublistCount &gt; <span class="number">0</span> &#123;</div><div class="line">        <span class="keyword">for</span> pos <span class="keyword">in</span> <span class="number">0</span>..&lt;sublistCount &#123;</div><div class="line">            <span class="built_in">insertionSort</span>(&amp;list, start: pos, gap: sublistCount)</div><div class="line">        &#125;</div><div class="line">        sublistCount = sublistCount / <span class="number">2</span></div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line">shellSort(&amp;arr)</div></pre></td></tr></table></figure>
<h1 id="Fast-sorts"><a href="#Fast-sorts" class="headerlink" title="Fast sorts:"></a>Fast sorts:</h1><h2 id="Quicksort"><a href="#Quicksort" class="headerlink" title="Quicksort"></a>Quicksort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/quickSort.gif" alt="quickSort"></p>
<p>Goal: Sort an array from low to high (or high to low).</p>
<p>Quicksort is one of the most famous algorithms in history. It was invented way back in 1959 by Tony Hoare, at a time when recursion was still a fairly nebulous concept.</p>
<p>Here’s an implementation in Swift that should be easy to understand:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quicksort</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: [T])</span></span> -&gt; [<span class="type">T</span>] &#123;</div><div class="line">  <span class="keyword">guard</span> a.<span class="built_in">count</span> &gt; <span class="number">1</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> a &#125;</div><div class="line"></div><div class="line">  <span class="keyword">let</span> pivot = a[a.<span class="built_in">count</span>/<span class="number">2</span>]</div><div class="line">  <span class="keyword">let</span> less = a.<span class="built_in">filter</span> &#123; $<span class="number">0</span> &lt; pivot &#125;</div><div class="line">  <span class="keyword">let</span> <span class="built_in">equal</span> = a.<span class="built_in">filter</span> &#123; $<span class="number">0</span> == pivot &#125;</div><div class="line">  <span class="keyword">let</span> greater = a.<span class="built_in">filter</span> &#123; $<span class="number">0</span> &gt; pivot &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> quicksort(less) + <span class="built_in">equal</span> + quicksort(greater)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Put this code in a playground and test it like so:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> list = [ <span class="number">10</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">1</span>, <span class="number">26</span> ]</div><div class="line">quicksort(list)</div></pre></td></tr></table></figure>
<p>Here’s how it works. When given an array, <code>quicksort()</code> splits it up into three parts based on a “pivot” variable. Here, the pivot is taken to be the element in the middle of the array (later on you’ll see other ways to choose the pivot).</p>
<p>All the elements less than the pivot go into a new array called <code>less</code>. All the elements equal to the pivot go into the <code>equal</code> array. And you guessed it, all elements greater than the pivot go into the third array, <code>greater</code>. This is why the generic type <code>T</code> must be <code>Comparable</code>, so we can compare the elements with <code>&lt;</code>, <code>==</code>, and <code>&gt;</code>.</p>
<p>Once we have these three arrays, <code>quicksort()</code> recursively sorts the <code>less</code> array and the <code>greater</code> array, then glues those sorted subarrays back together with the <code>equal</code> array to get the final result.</p>
<h3 id="An-example-3"><a href="#An-example-3" class="headerlink" title="An example"></a>An example</h3><p>Let’s walk through the example. The array is initially:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 10, 0, 3, 9, 2, 14, 8, 27, 1, 5, 8, -1, 26 ]</div></pre></td></tr></table></figure>
<p>First, we pick the pivot element. That is <code>8</code> because it’s in the middle of the array. Now we split the array into the less, equal, and greater parts:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">less:    [ 0, 3, 2, 1, 5, -1 ]</div><div class="line">equal:   [ 8, 8 ]</div><div class="line">greater: [ 10, 9, 14, 27, 26 ]</div></pre></td></tr></table></figure>
<p>This is a good split because <code>less</code> and <code>greater</code> roughly contain the same number of elements. So we’ve picked a good pivot that chopped the array right down the middle.</p>
<p>Note that the <code>less</code> and <code>greater</code> arrays aren’t sorted yet, so we call <code>quicksort()</code> again to sort those two subarrays. That does the exact same thing: pick a pivot and split the subarray into three even smaller parts.</p>
<p>Let’s just take a look at the <code>less</code> array:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 0, 3, 2, 1, 5, -1 ]</div></pre></td></tr></table></figure>
<p>The pivot element is the one in the middle, <code>1</code>. (You could also have picked <code>2</code>, it doesn’t matter.) Again, we create three subarrays around the pivot:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">less:    [ 0, -1 ]</div><div class="line">equal:   [ 1 ]</div><div class="line">greater: [ 3, 2, 5 ]</div></pre></td></tr></table></figure>
<p>We’re not done yet and <code>quicksort()</code> again is called recursively on the <code>less</code> and <code>greater</code> arrays. Let’s look at <code>less</code>again:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 0, -1 ]</div></pre></td></tr></table></figure>
<p>As pivot we pick <code>-1</code>. Now the subarrays are:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">less:    [ ]</div><div class="line">equal:   [ -1 ]</div><div class="line">greater: [ 0 ]</div></pre></td></tr></table></figure>
<p>The <code>less</code> array is empty because there was no value smaller than <code>-1</code>; the other arrays contain a single element each. That means we’re done at this level of the recursion, and we go back up to sort the previous <code>greater</code> array.</p>
<p>That <code>greater</code> array was:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 3, 2, 5 ]</div></pre></td></tr></table></figure>
<p>This works just the same way as before: we pick the middle element <code>2</code> as the pivot and fill up the subarrays:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">less:    [ ]</div><div class="line">equal:   [ 2 ]</div><div class="line">greater: [ 3, 5 ]</div></pre></td></tr></table></figure>
<p>Note that here it would have been better to pick <code>3</code> as the pivot – we would have been done sooner. But now we have to recurse into the <code>greater</code> array again to make sure it is sorted. This is why picking a good pivot is important. When you pick too many “bad” pivots, quicksort actually becomes really slow. More on that below.</p>
<p>When we partition the <code>greater</code> subarray, we find:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">less:    [ 3 ]</div><div class="line">equal:   [ 5 ]</div><div class="line">greater: [ ]</div></pre></td></tr></table></figure>
<p>And now we’re done at this level of the recursion because we can’t split up the arrays any further.</p>
<p>This process repeats until all the subarrays have been sorted. In a picture:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Quicksort/Images/Example.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Quicksort/Images/Example.png" alt="Example"></a></p>
<p>Now if you read the colored boxes from left to right, you get the sorted array:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 0, 1, 2, 3, 5, 8, 8, 9, 10, 14, 26, 27 ]</div></pre></td></tr></table></figure>
<p>This shows that <code>8</code> was a good initial pivot because it appears in the middle of the sorted array too.</p>
<p>I hope this makes the basic principle clear of how quicksort works. Unfortunately, this version of quicksort isn’t very quick, because we <code>filter()</code> the same array three times. There are more clever ways to split up the array.</p>
<h3 id="Partitioning"><a href="#Partitioning" class="headerlink" title="Partitioning"></a>Partitioning</h3><p>Dividing the array around the pivot is called <em>partitioning</em> and there are a few different partitioning schemes.</p>
<p>If the array is,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 10, 0, 3, 9, 2, 14, 8, 27, 1, 5, 8, -1, 26 ]</div></pre></td></tr></table></figure>
<p>and we choose the middle element <code>8</code> as a pivot then after partitioning the array will look like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ 0, 3, 2, 1, 5, -1, 8, 8, 10, 9, 14, 27, 26 ]</div><div class="line">  -----------------        -----------------</div><div class="line">  all elements &lt; 8         all elements &gt; 8</div></pre></td></tr></table></figure>
<p>The key thing to realize is that after partitioning the pivot element is in its final sorted place already. The rest of the numbers are not sorted yet, they are simply partitioned around the pivot value. Quicksort partitions the array many times over, until all the values are in their final places.</p>
<p>There is no guarantee that partitioning keeps the elements in the same relative order, so after partitioning around pivot <code>8</code>you could also end up with something like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 3, 0, 5, 2, -1, 1, 8, 8, 14, 26, 10, 27, 9 ]</div></pre></td></tr></table></figure>
<p>The only guarantee is that to the left of the pivot are all the smaller elements and to the right are all the larger elements. Because partitioning can change the original order of equal elements, quicksort does not produce a “stable” sort (unlike <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Merge%20Sort" target="_blank" rel="external">merge sort</a>, for example). Most of the time that’s not a big deal.</p>
<h3 id="Lomuto’s-partitioning-scheme"><a href="#Lomuto’s-partitioning-scheme" class="headerlink" title="Lomuto’s partitioning scheme"></a>Lomuto’s partitioning scheme</h3><p>In the first example of quicksort I showed you, partitioning was done by calling Swift’s <code>filter()</code> function three times. That is not very efficient. So let’s look at a smarter partitioning algorithm that works <em>in place</em>, i.e. by modifying the original array.</p>
<p>Here’s an implementation of Lomuto’s partitioning scheme in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">partitionLomuto</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">  <span class="keyword">let</span> pivot = a[high]</div><div class="line"></div><div class="line">  <span class="keyword">var</span> i = low</div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> low..&lt;high &#123;</div><div class="line">    <span class="keyword">if</span> a[j] &lt;= pivot &#123;</div><div class="line">      (a[i], a[j]) = (a[j], a[i])</div><div class="line">      i += <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  (a[i], a[high]) = (a[high], a[i])</div><div class="line">  <span class="keyword">return</span> i</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>To test this in a playground, do:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [ <span class="number">10</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">1</span>, <span class="number">8</span> ]</div><div class="line"><span class="keyword">let</span> p = partitionLomuto(&amp;list, low: <span class="number">0</span>, high: list.<span class="built_in">count</span> - <span class="number">1</span>)</div><div class="line">list  <span class="comment">// show the results</span></div></pre></td></tr></table></figure>
<p>Note that <code>list</code> needs to be a <code>var</code> because <code>partitionLomuto()</code> directly changes the contents of the array (it is passed as an <code>inout</code> parameter). That is much more efficient than allocating a new array object.</p>
<p>The <code>low</code> and <code>high</code> parameters are necessary because when this is used inside quicksort, you don’t always want to (re)partition the entire array, only a limited range that becomes smaller and smaller.</p>
<p>Previously we used the middle array element as the pivot but it’s important to realize that the Lomuto algorithm always uses the <em>last</em> element, <code>a[high]</code>, for the pivot. Because we’ve been pivoting around <code>8</code> all this time, I swapped the positions of <code>8</code> and <code>26</code> in the example so that <code>8</code> is at the end of the array and is used as the pivot value here too.</p>
<p>After partitioning, the array looks like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 0, 3, 2, 1, 5, 8, -1, 8, 9, 10, 14, 26, 27 ]</div><div class="line">                        *</div></pre></td></tr></table></figure>
<p>The variable <code>p</code> contains the return value of the call to <code>partitionLomuto()</code> and is 7. This is the index of the pivot element in the new array (marked with a star).</p>
<p>The left partition goes from 0 to <code>p-1</code> and is <code>[ 0, 3, 2, 1, 5, 8, -1 ]</code>. The right partition goes from <code>p+1</code> to the end, and is <code>[ 9, 10, 14, 26, 27 ]</code> (the fact that the right partition is already sorted is a coincidence).</p>
<p>You may notice something interesting… The value <code>8</code> occurs more than once in the array. One of those <code>8</code>s did not end up neatly in the middle but somewhere in the left partition. That’s a small downside of the Lomuto algorithm as it makes quicksort slower if there are a lot of duplicate elements.</p>
<p>So how does the Lomuto algorithm actually work? The magic happens in the <code>for</code> loop. This loop divides the array into four regions:</p>
<ol>
<li><code>a[low...i]</code> contains all values &lt;= pivot</li>
<li><code>a[i+1...j-1]</code> contains all values &gt; pivot</li>
<li><code>a[j...high-1]</code> are values we haven’t looked at yet</li>
<li><code>a[high]</code> is the pivot value</li>
</ol>
<p>In ASCII art the array is divided up like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ values &lt;= pivot | values &gt; pivot | not looked at yet | pivot ]</div><div class="line">  low           i   i+1        j-1   j          high-1   high</div></pre></td></tr></table></figure>
<p>The loop looks at each element from <code>low</code> to <code>high-1</code> in turn. If the value of the current element is less than or equal to the pivot, it is moved into the first region using a swap.</p>
<blockquote>
<p><strong>Note:</strong> In Swift, the notation <code>(x, y) = (y, x)</code> is a convenient way to perform a swap between the values of <code>x</code> and <code>y</code>. You can also write <code>swap(&amp;x, &amp;y)</code>.</p>
</blockquote>
<p>After the loop is over, the pivot is still the last element in the array. So we swap it with the first element that is greater than the pivot. Now the pivot sits between the &lt;= and &gt; regions and the array is properly partitioned.</p>
<p>Let’s step through the example. The array we’re starting with is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[| 10, 0, 3, 9, 2, 14, 26, 27, 1, 5, 8, -1 | 8 ]</div><div class="line">   low                                       high</div><div class="line">   i</div><div class="line">   j</div></pre></td></tr></table></figure>
<p>Initially, the “not looked at” region stretches from index 0 to 11. The pivot is at index 12. The “values &lt;= pivot” and “values &gt; pivot” regions are empty, because we haven’t looked at any values yet.</p>
<p>Look at the first value, <code>10</code>. Is this smaller than the pivot? No, skip to the next element.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[| 10 | 0, 3, 9, 2, 14, 26, 27, 1, 5, 8, -1 | 8 ]</div><div class="line">   low                                        high</div><div class="line">   i</div><div class="line">       j</div></pre></td></tr></table></figure>
<p>Now the “not looked at” region goes from index 1 to 11, the “values &gt; pivot” region contains the number <code>10</code>, and “values &lt;= pivot” is still empty.</p>
<p>Look at the second value, <code>0</code>. Is this smaller than the pivot? Yes, so swap <code>10</code> with <code>0</code> and move <code>i</code> ahead by one.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[ 0 | 10 | 3, 9, 2, 14, 26, 27, 1, 5, 8, -1 | 8 ]</div><div class="line">  low                                         high</div><div class="line">      i</div><div class="line">           j</div></pre></td></tr></table></figure>
<p>Now “not looked at” goes from index 2 to 11, “values &gt; pivot” still contains <code>10</code>, and “values &lt;= pivot” contains the number <code>0</code>.</p>
<p>Look at the third value, <code>3</code>. This is smaller than the pivot, so swap it with <code>10</code> to get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[ 0, 3 | 10 | 9, 2, 14, 26, 27, 1, 5, 8, -1 | 8 ]</div><div class="line">  low                                         high</div><div class="line">         i</div><div class="line">             j</div></pre></td></tr></table></figure>
<p>The “values &lt;= pivot” region is now <code>[ 0, 3 ]</code>. Let’s do one more… <code>9</code> is greater than the pivot, so simply skip ahead:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">[ 0, 3 | 10, 9 | 2, 14, 26, 27, 1, 5, 8, -1 | 8 ]</div><div class="line">  low                                         high</div><div class="line">         i</div><div class="line">                 j</div></pre></td></tr></table></figure>
<p>Now the “values &gt; pivot” region contains <code>[ 10, 9 ]</code>. If we keep going this way, then eventually we end up with:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ 0, 3, 2, 1, 5, 8, -1 | 27, 9, 10, 14, 26 | 8 ]</div><div class="line">  low                                        high</div><div class="line">                         i                   j</div></pre></td></tr></table></figure>
<p>The final thing to do is to put the pivot into place by swapping <code>a[i]</code> with <code>a[high]</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">[ 0, 3, 2, 1, 5, 8, -1 | 8 | 9, 10, 14, 26, 27 ]</div><div class="line">  low                                       high</div><div class="line">                         i                  j</div></pre></td></tr></table></figure>
<p>And we return <code>i</code>, the index of the pivot element.</p>
<blockquote>
<p><strong>Note:</strong> If you’re still not entirely clear on how the algorithm works, I suggest you play with this in the playground to see exactly how the loop creates these four regions.</p>
</blockquote>
<p>Let’s use this partitioning scheme to build quicksort. Here’s the code:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quicksortLomuto</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> &#123;</div><div class="line">  <span class="keyword">if</span> low &lt; high &#123;</div><div class="line">    <span class="keyword">let</span> p = partitionLomuto(&amp;a, low: low, high: high)</div><div class="line">    quicksortLomuto(&amp;a, low: low, high: p - <span class="number">1</span>)</div><div class="line">    quicksortLomuto(&amp;a, low: p + <span class="number">1</span>, high: high)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This is now super simple. We first call <code>partitionLomuto()</code> to reorder the array around the pivot (which is always the last element from the array). And then we call <code>quicksortLomuto()</code> recursively to sort the left and right partitions.</p>
<p>Try it out:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [ <span class="number">10</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">26</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">1</span>, <span class="number">8</span> ]</div><div class="line">quicksortLomuto(&amp;list, low: <span class="number">0</span>, high: list.<span class="built_in">count</span> - <span class="number">1</span>)</div></pre></td></tr></table></figure>
<p>Lomuto’s isn’t the only partitioning scheme but it’s probably the easiest to understand. It’s not as efficient as Hoare’s scheme, which requires fewer swap operations.</p>
<h3 id="Hoare’s-partitioning-scheme"><a href="#Hoare’s-partitioning-scheme" class="headerlink" title="Hoare’s partitioning scheme"></a>Hoare’s partitioning scheme</h3><p>This partitioning scheme is by Hoare, the inventor of quicksort.</p>
<p>Here is the code:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">partitionHoare</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> -&gt; <span class="type">Int</span> &#123;</div><div class="line">  <span class="keyword">let</span> pivot = a[low]</div><div class="line">  <span class="keyword">var</span> i = low - <span class="number">1</span></div><div class="line">  <span class="keyword">var</span> j = high + <span class="number">1</span></div><div class="line"></div><div class="line">  <span class="keyword">while</span> <span class="literal">true</span> &#123;</div><div class="line">    <span class="keyword">repeat</span> &#123; j -= <span class="number">1</span> &#125; <span class="keyword">while</span> a[j] &gt; pivot</div><div class="line">    <span class="keyword">repeat</span> &#123; i += <span class="number">1</span> &#125; <span class="keyword">while</span> a[i] &lt; pivot</div><div class="line"></div><div class="line">    <span class="keyword">if</span> i &lt; j &#123;</div><div class="line">      a.swapAt(i, j)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> j</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>To test this in a playground, do:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [ <span class="number">8</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">10</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">1</span>, <span class="number">26</span> ]</div><div class="line"><span class="keyword">let</span> p = partitionHoare(&amp;list, low: <span class="number">0</span>, high: list.<span class="built_in">count</span> - <span class="number">1</span>)</div><div class="line">list  <span class="comment">// show the results</span></div></pre></td></tr></table></figure>
<p>Note that with Hoare’s scheme, the pivot is always expected to be the <em>first</em> element in the array, <code>a[low]</code>. Again, we’re using <code>8</code> as the pivot element.</p>
<p>The result is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 0, 3, 8, 2, 5, 1, 27, 10, 14, 9, 8, 26 ]</div></pre></td></tr></table></figure>
<p>Note that this time the pivot isn’t in the middle at all. Unlike with Lomuto’s scheme, the return value is not necessarily the index of the pivot element in the new array.</p>
<p>Instead, the array is partitioned into the regions <code>[low...p]</code> and <code>[p+1...high]</code>. Here, the return value <code>p</code> is 6, so the two partitions are <code>[ -1, 0, 3, 8, 2, 5, 1 ]</code> and <code>[ 27, 10, 14, 9, 8, 26 ]</code>.</p>
<p>The pivot is placed somewhere inside one of the two partitions, but the algorithm doesn’t tell you which one or where. If the pivot value occurs more than once, then some instances may appear in the left partition and others may appear in the right partition.</p>
<p>Because of these differences, the implementation of Hoare’s quicksort is slightly different:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quicksortHoare</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> &#123;</div><div class="line">  <span class="keyword">if</span> low &lt; high &#123;</div><div class="line">    <span class="keyword">let</span> p = partitionHoare(&amp;a, low: low, high: high)</div><div class="line">    quicksortHoare(&amp;a, low: low, high: p)</div><div class="line">    quicksortHoare(&amp;a, low: p + <span class="number">1</span>, high: high)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>I’ll leave it as an exercise for the reader to figure out exactly how Hoare’s partitioning scheme works. :-)</p>
<h3 id="Picking-a-good-pivot"><a href="#Picking-a-good-pivot" class="headerlink" title="Picking a good pivot"></a>Picking a good pivot</h3><p>Lomuto’s partitioning scheme always chooses the last array element for the pivot. Hoare’s scheme uses the first element. But there is no guarantee that these pivots are any good.</p>
<p>Here is what happens when you pick a bad value for the pivot. Let’s say the array is,</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 7, 6, 5, 4, 3, 2, 1 ]</div></pre></td></tr></table></figure>
<p>and we’re using Lomuto’s scheme. The pivot is the last element, <code>1</code>. After pivoting, we have the following arrays:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">   less than pivot: [ ]</div><div class="line">    equal to pivot: [ 1 ]</div><div class="line">greater than pivot: [ 7, 6, 5, 4, 3, 2 ]</div></pre></td></tr></table></figure>
<p>Now recursively partition the “greater than” subarray and get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">   less than pivot: [ ]</div><div class="line">    equal to pivot: [ 2 ]</div><div class="line">greater than pivot: [ 7, 6, 5, 4, 3 ]</div></pre></td></tr></table></figure>
<p>And again:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">   less than pivot: [ ]</div><div class="line">    equal to pivot: [ 3 ]</div><div class="line">greater than pivot: [ 7, 6, 5, 4 ]</div></pre></td></tr></table></figure>
<p>And so on…</p>
<p>That’s no good, because this pretty much reduces quicksort to the much slower insertion sort. For quicksort to be efficient, it needs to split the array into roughly two halves.</p>
<p>The optimal pivot for this example would have been <code>4</code>, so we’d get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">   less than pivot: [ 3, 2, 1 ]</div><div class="line">    equal to pivot: [ 4 ]</div><div class="line">greater than pivot: [ 7, 6, 5 ]</div></pre></td></tr></table></figure>
<p>You might think this means we should always choose the middle element rather than the first or the last, but imagine what happens in the following situation:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 7, 6, 5, 1, 4, 3, 2 ]</div></pre></td></tr></table></figure>
<p>Now the middle element is <code>1</code> and that gives the same lousy results as in the previous example.</p>
<p>Ideally, the pivot is the <em>median</em> element of the array that you’re partitioning, i.e. the element that sits in the middle of the sorted array. Of course, you won’t know what the median is until after you’ve sorted the array, so this is a bit of a chicken-and-egg problem. However, there are some tricks to choose good, if not ideal, pivots.</p>
<p>One trick is “median-of-three”, where you find the median of the first, middle, and last element in this subarray. In theory that often gives a good approximation of the true median.</p>
<p>Another common solution is to choose the pivot randomly. Sometimes this may result in choosing a suboptimal pivot but on average this gives very good results.</p>
<p>Here is how you can do quicksort with a randomly chosen pivot:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quicksortRandom</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> &#123;</div><div class="line">  <span class="keyword">if</span> low &lt; high &#123;</div><div class="line">    <span class="keyword">let</span> pivotIndex = random(<span class="built_in">min</span>: low, <span class="built_in">max</span>: high)         <span class="comment">// 1</span></div><div class="line"></div><div class="line">    (a[pivotIndex], a[high]) = (a[high], a[pivotIndex])  <span class="comment">// 2</span></div><div class="line"></div><div class="line">    <span class="keyword">let</span> p = partitionLomuto(&amp;a, low: low, high: high)</div><div class="line">    quicksortRandom(&amp;a, low: low, high: p - <span class="number">1</span>)</div><div class="line">    quicksortRandom(&amp;a, low: p + <span class="number">1</span>, high: high)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>There are two important differences with before:</p>
<ol>
<li>The <code>random(min:max:)</code> function returns an integer in the range <code>min...max</code>, inclusive. This is our pivot index.</li>
<li>Because the Lomuto scheme expects <code>a[high]</code> to be the pivot entry, we swap <code>a[pivotIndex]</code> with <code>a[high]</code> to put the pivot element at the end before calling <code>partitionLomuto()</code>.</li>
</ol>
<p>It may seem strange to use random numbers in something like a sorting function, but it is necessary to make quicksort behave efficiently under all circumstances. With bad pivots, the performance of quicksort can be quite horrible, <strong>O(n^2)</strong>. But if you choose good pivots on average, for example by using a random number generator, the expected running time becomes <strong>O(n log n)</strong>, which is as good as sorting algorithms get.</p>
<h3 id="Dutch-national-flag-🇳🇱-partitioning"><a href="#Dutch-national-flag-🇳🇱-partitioning" class="headerlink" title="Dutch national flag 🇳🇱 partitioning"></a>Dutch national flag 🇳🇱 partitioning</h3><p>But there are more improvements to make! In the first example of quicksort I showed you, we ended up with an array that was partitioned like this:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ values &lt; pivot | values equal to pivot | values &gt; pivot ]</div></pre></td></tr></table></figure>
<p>But as you’ve seen with the Lomuto partitioning scheme, if the pivot occurs more than once the duplicates end up in the left half. And with Hoare’s scheme the pivot can be all over the place. The solution to this is “Dutch national flag” partitioning, named after the fact that the <a href="https://en.wikipedia.org/wiki/Flag_of_the_Netherlands" target="_blank" rel="external">Dutch flag</a> has three bands just like we want to have three partitions.</p>
<p>The code for this scheme is:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">partitionDutchFlag</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int, pivotIndex: Int)</span></span> -&gt; (<span class="type">Int</span>, <span class="type">Int</span>) &#123;</div><div class="line">  <span class="keyword">let</span> pivot = a[pivotIndex]</div><div class="line"></div><div class="line">  <span class="keyword">var</span> smaller = low</div><div class="line">  <span class="keyword">var</span> <span class="built_in">equal</span> = low</div><div class="line">  <span class="keyword">var</span> larger = high</div><div class="line"></div><div class="line">  <span class="keyword">while</span> <span class="built_in">equal</span> &lt;= larger &#123;</div><div class="line">    <span class="keyword">if</span> a[<span class="built_in">equal</span>] &lt; pivot &#123;</div><div class="line">      <span class="built_in">swap</span>(&amp;a, smaller, <span class="built_in">equal</span>)</div><div class="line">      smaller += <span class="number">1</span></div><div class="line">      <span class="built_in">equal</span> += <span class="number">1</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> a[<span class="built_in">equal</span>] == pivot &#123;</div><div class="line">      <span class="built_in">equal</span> += <span class="number">1</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      <span class="built_in">swap</span>(&amp;a, <span class="built_in">equal</span>, larger)</div><div class="line">      larger -= <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> (smaller, larger)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This works very similarly to the Lomuto scheme, except that the loop partitions the array into four (possibly empty) regions:</p>
<ul>
<li><code>[low ... smaller-1]</code> contains all values &lt; pivot</li>
<li><code>[smaller ... equal-1]</code> contains all values == pivot</li>
<li><code>[equal ... larger]</code> contains all values &gt; pivot</li>
<li><code>[larger ... high]</code> are values we haven’t looked at yet</li>
</ul>
<p>Note that this doesn’t assume the pivot is in <code>a[high]</code>. Instead, you have to pass in the index of the element you wish to use as a pivot.</p>
<p>An example of how to use it:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> list = [ <span class="number">10</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">9</span>, <span class="number">2</span>, <span class="number">14</span>, <span class="number">8</span>, <span class="number">27</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">8</span>, -<span class="number">1</span>, <span class="number">26</span> ]</div><div class="line">partitionDutchFlag(&amp;list, low: <span class="number">0</span>, high: list.<span class="built_in">count</span> - <span class="number">1</span>, pivotIndex: <span class="number">10</span>)</div><div class="line">list  <span class="comment">// show the results</span></div></pre></td></tr></table></figure>
<p>Just for fun, we’re giving it the index of the other <code>8</code> this time. The result is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 0, 3, 2, 5, 1, 8, 8, 27, 14, 9, 26, 10 ]</div></pre></td></tr></table></figure>
<p>Notice how the two <code>8</code>s are in the middle now. The return value from <code>partitionDutchFlag()</code> is a tuple, <code>(6, 7)</code>. This is the range that contains the pivot value(s).</p>
<p>Here is how you would use it in quicksort:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quicksortDutchFlag</span>&lt;T: Comparable&gt;<span class="params">(<span class="number">_</span> a: <span class="keyword">inout</span> [T], low: Int, high: Int)</span></span> &#123;</div><div class="line">  <span class="keyword">if</span> low &lt; high &#123;</div><div class="line">    <span class="keyword">let</span> pivotIndex = random(<span class="built_in">min</span>: low, <span class="built_in">max</span>: high)</div><div class="line">    <span class="keyword">let</span> (p, q) = partitionDutchFlag(&amp;a, low: low, high: high, pivotIndex: pivotIndex)</div><div class="line">    quicksortDutchFlag(&amp;a, low: low, high: p - <span class="number">1</span>)</div><div class="line">    quicksortDutchFlag(&amp;a, low: q + <span class="number">1</span>, high: high)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Using Dutch flag partitioning makes for a more efficient quicksort if the array contains many duplicate elements. (And I’m not just saying that because I’m Dutch!)</p>
<blockquote>
<p><strong>Note:</strong> The above implementation of <code>partitionDutchFlag()</code> uses a custom <code>swap()</code> routine for swapping the contents of two array elements. Unlike Swift’s own <code>swap()</code>, this doesn’t give an error when the two indices refer to the same array element. See <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Quicksort/Quicksort.swift" target="_blank" rel="external">Quicksort.swift</a> for the code.</p>
</blockquote>
<h2 id="Merge-Sort"><a href="#Merge-Sort" class="headerlink" title="Merge Sort"></a>Merge Sort</h2><blockquote>
<p>This topic has been tutorialized <a href="https://www.raywenderlich.com/154256/swift-algorithm-club-swift-merge-sort" target="_blank" rel="external">here</a></p>
</blockquote>
<p>Goal: Sort an array from low to high (or high to low)</p>
<p>Invented in 1945 by John von Neumann, merge-sort is an efficient algorithm with a best, worst, and average time complexity of <strong>O(n log n)</strong>.</p>
<p>The merge-sort algorithm uses the <strong>divide and conquer</strong> approach which is to divide a big problem into smaller problems and solve them. I think of the merge-sort algorithm as <strong>split first</strong> and <strong>merge after</strong>.</p>
<p>Assume you need to sort an array of <em>n</em> numbers in the right order. The merge-sort algorithm works as follows:</p>
<ul>
<li>Put the numbers in an unsorted pile.</li>
<li>Split the pile into two. Now, you have <strong>two unsorted piles</strong> of numbers.</li>
<li>Keep splitting the resulting piles until you cannot split anymore. In the end, you will have <em>n</em> piles with one number in each pile.</li>
<li>Begin to <strong>merge</strong> the piles together by pairing them sequentially. During each merge, put the contents in sorted order. This is fairly easy because each individual pile is already sorted.</li>
</ul>
<h3 id="An-example-4"><a href="#An-example-4" class="headerlink" title="An example"></a>An example</h3><h4 id="Splitting"><a href="#Splitting" class="headerlink" title="Splitting"></a>Splitting</h4><p>Assume you are given an array of <em>n</em> numbers as<code>[2, 1, 5, 4, 9]</code>. This is an unsorted pile. The goal is to keep splitting the pile until you cannot split anymore.</p>
<p>First, split the array into two halves: <code>[2, 1]</code> and <code>[5, 4, 9]</code>. Can you keep splitting them? Yes, you can!</p>
<p>Focus on the left pile. Split<code>[2, 1]</code> into <code>[2]</code> and <code>[1]</code>. Can you keep splitting them? No. Time to check the other pile.</p>
<p>Split <code>[5, 4, 9]</code> into <code>[5]</code> and <code>[4, 9]</code>. Unsurprisingly, <code>[5]</code> cannot be split anymore, but <code>[4, 9]</code> can be split into <code>[4]</code>and <code>[9]</code>.</p>
<p>The splitting process ends with the following piles: <code>[2]</code> <code>[1]</code> <code>[5]</code> <code>[4]</code> <code>[9]</code>. Notice that each pile consists of just one element.</p>
<h4 id="Merging"><a href="#Merging" class="headerlink" title="Merging"></a>Merging</h4><p>Now that you have split the array, you should <strong>merge</strong> the piles together <strong>while sorting them</strong>. Remember, the idea is to solve many small problems rather than a big one. For each merge iteration, you must be concerned at merging one pile with another.</p>
<p>Given the piles <code>[2]</code> <code>[1]</code> <code>[5]</code> <code>[4]</code> <code>[9]</code>, the first pass will result in <code>[1, 2]</code> and <code>[4, 5]</code> and <code>[9]</code>. Since <code>[9]</code> is the odd one out, you cannot merge it with anything during this pass.</p>
<p>The next pass will merge <code>[1, 2]</code> and <code>[4, 5]</code> together. This results in <code>[1, 2, 4, 5]</code>, with the <code>[9]</code> left out again because it is the odd one out.</p>
<p>You are left with only two piles <code>[1, 2, 4, 5]</code> and <code>[9]</code>, finally gets its chance to merge, resulting in the sorted array as <code>[1, 2, 4, 5, 9]</code>.</p>
<h3 id="Top-down-implementation"><a href="#Top-down-implementation" class="headerlink" title="Top-down implementation"></a>Top-down implementation</h3><p>Here’s what merge sort may look like in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">mergeSort</span><span class="params">(<span class="number">_</span> array: [Int])</span></span> -&gt; [<span class="type">Int</span>] &#123;</div><div class="line">  <span class="keyword">guard</span> array.<span class="built_in">count</span> &gt; <span class="number">1</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> array &#125;    <span class="comment">// 1</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> middleIndex = array.<span class="built_in">count</span> / <span class="number">2</span>              <span class="comment">// 2</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> leftArray = mergeSort(<span class="type">Array</span>(array[<span class="number">0</span>..&lt;middleIndex]))             <span class="comment">// 3</span></div><div class="line"></div><div class="line">  <span class="keyword">let</span> rightArray = mergeSort(<span class="type">Array</span>(array[middleIndex..&lt;array.<span class="built_in">count</span>]))  <span class="comment">// 4</span></div><div class="line"></div><div class="line">  <span class="keyword">return</span> merge(leftPile: leftArray, rightPile: rightArray)             <span class="comment">// 5</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>A step-by-step explanation of how the code works:</p>
<ol>
<li>If the array is empty or contains a single element, there is no way to split it into smaller pieces. You must just return the array.</li>
<li>Find the middle index.</li>
<li>Using the middle index from the previous step, recursively split the left side of the array.</li>
<li>Also, recursively split the right side of the array.</li>
<li>Finally, merge all the values together, making sure that it is always sorted.</li>
</ol>
<p>Here’s the merging algorithm:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">merge</span><span class="params">(leftPile: [Int], rightPile: [Int])</span></span> -&gt; [<span class="type">Int</span>] &#123;</div><div class="line">  <span class="comment">// 1</span></div><div class="line">  <span class="keyword">var</span> leftIndex = <span class="number">0</span></div><div class="line">  <span class="keyword">var</span> rightIndex = <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="comment">// 2</span></div><div class="line">  <span class="keyword">var</span> orderedPile = [<span class="type">Int</span>]()</div><div class="line">  orderedPile.reserveCapacity(leftPile.<span class="built_in">count</span> + rightPile.<span class="built_in">count</span>)</div><div class="line"></div><div class="line">  <span class="comment">// 3</span></div><div class="line">  <span class="keyword">while</span> leftIndex &lt; leftPile.<span class="built_in">count</span> &amp;&amp; rightIndex &lt; rightPile.<span class="built_in">count</span> &#123;</div><div class="line">    <span class="keyword">if</span> leftPile[leftIndex] &lt; rightPile[rightIndex] &#123;</div><div class="line">      orderedPile.append(leftPile[leftIndex])</div><div class="line">      leftIndex += <span class="number">1</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> leftPile[leftIndex] &gt; rightPile[rightIndex] &#123;</div><div class="line">      orderedPile.append(rightPile[rightIndex])</div><div class="line">      rightIndex += <span class="number">1</span></div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      orderedPile.append(leftPile[leftIndex])</div><div class="line">      leftIndex += <span class="number">1</span></div><div class="line">      orderedPile.append(rightPile[rightIndex])</div><div class="line">      rightIndex += <span class="number">1</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// 4</span></div><div class="line">  <span class="keyword">while</span> leftIndex &lt; leftPile.<span class="built_in">count</span> &#123;</div><div class="line">    orderedPile.append(leftPile[leftIndex])</div><div class="line">    leftIndex += <span class="number">1</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">while</span> rightIndex &lt; rightPile.<span class="built_in">count</span> &#123;</div><div class="line">    orderedPile.append(rightPile[rightIndex])</div><div class="line">    rightIndex += <span class="number">1</span></div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="keyword">return</span> orderedPile</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This method may look scary, but it is quite straightforward:</p>
<ol>
<li>You need two indexes to keep track of your progress for the two arrays while merging.</li>
<li>This is the merged array. It is empty right now, but you will build it up in subsequent steps by appending elements from the other arrays. Since you already know number of elements that will end up in this array, you reserve capacity to avoid reallocation overhead later.</li>
<li>This while-loop will compare the elements from the left and right sides and append them into the <code>orderedPile</code> while making sure that the result stays in order.</li>
<li>If control exits from the previous while-loop, it means that either the <code>leftPile</code> or the <code>rightPile</code> has its contents completely merged into the <code>orderedPile</code>. At this point, you no longer need to do comparisons. Just append the rest of the contents of the other array until there is no more to append.</li>
</ol>
<p>As an example of how <code>merge()</code> works, suppose that we have the following piles: <code>leftPile = [1, 7, 8]</code> and <code>rightPile = [3, 6, 9]</code>. Note that each of these piles is individually sorted already – that is always true with merge sort. These are merged into one larger sorted pile in the following steps:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ ]</div><div class="line">  l              r</div></pre></td></tr></table></figure>
<p>The left index, here represented as <code>l</code>, points at the first item from the left pile, <code>1</code>. The right index, <code>r</code>, points at <code>3</code>. Therefore, the first item we add to <code>orderedPile</code> is <code>1</code>. We also move the left index <code>l</code> to the next item.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ 1 ]</div><div class="line">  --&gt;l           r</div></pre></td></tr></table></figure>
<p>Now <code>l</code> points at <code>7</code> but <code>r</code> is still at <code>3</code>. We add the smallest item to the ordered pile, so that is <code>3</code>. The situation is now:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ 1, 3 ]</div><div class="line">     l           --&gt;r</div></pre></td></tr></table></figure>
<p>This process repeats. At each step, we pick the smallest item from either the <code>leftPile</code> or the <code>rightPile</code> and add the item into the <code>orderedPile</code>:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ 1, 3, 6 ]</div><div class="line">     l              --&gt;r</div><div class="line"></div><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ 1, 3, 6, 7 ]</div><div class="line">     --&gt;l              r</div><div class="line"></div><div class="line">leftPile       rightPile       orderedPile</div><div class="line">[ 1, 7, 8 ]    [ 3, 6, 9 ]     [ 1, 3, 6, 7, 8 ]</div><div class="line">        --&gt;l           r</div></pre></td></tr></table></figure>
<p>Now, there are no more items in the left pile. We simply add the remaining items from the right pile, and we are done. The merged pile is <code>[ 1, 3, 6, 7, 8, 9 ]</code>.</p>
<p>Notice that, this algorithm is very simple: it moves from left-to-right through the two piles and at every step picks the smallest item. This works because we guarantee that each of the piles is already sorted.</p>
<p><a href="http://www.algomation.com/player?algorithm=58bb32885b2b830400b05123" target="_blank" rel="external">Here is a dynamic implementation process</a></p>
<h3 id="Bottom-up-implementation"><a href="#Bottom-up-implementation" class="headerlink" title="Bottom-up implementation"></a>Bottom-up implementation</h3><p>The implementation of the merge-sort algorithm you have seen so far is called the “top-down” approach because it first splits the array into smaller piles and then merges them. When sorting an array (as opposed to, say, a linked list) you can actually skip the splitting step and immediately start merging the individual array elements. This is called the “bottom-up” approach.</p>
<p>Time to step up the game a little. :-) Here is a complete bottom-up implementation in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">mergeSortBottomUp</span>&lt;T&gt;<span class="params">(<span class="number">_</span> a: [T], <span class="number">_</span> isOrderedBefore: <span class="params">(T, T)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">T</span>] &#123;</div><div class="line">  <span class="keyword">let</span> n = a.<span class="built_in">count</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> z = [a, a]      <span class="comment">// 1</span></div><div class="line">  <span class="keyword">var</span> d = <span class="number">0</span></div><div class="line"></div><div class="line">  <span class="keyword">var</span> width = <span class="number">1</span></div><div class="line">  <span class="keyword">while</span> width &lt; n &#123;   <span class="comment">// 2</span></div><div class="line"></div><div class="line">    <span class="keyword">var</span> i = <span class="number">0</span></div><div class="line">    <span class="keyword">while</span> i &lt; n &#123;     <span class="comment">// 3</span></div><div class="line"></div><div class="line">      <span class="keyword">var</span> j = i</div><div class="line">      <span class="keyword">var</span> l = i</div><div class="line">      <span class="keyword">var</span> r = i + width</div><div class="line"></div><div class="line">      <span class="keyword">let</span> lmax = <span class="built_in">min</span>(l + width, n)</div><div class="line">      <span class="keyword">let</span> rmax = <span class="built_in">min</span>(r + width, n)</div><div class="line"></div><div class="line">      <span class="keyword">while</span> l &lt; lmax &amp;&amp; r &lt; rmax &#123;                <span class="comment">// 4</span></div><div class="line">        <span class="keyword">if</span> isOrderedBefore(z[d][l], z[d][r]) &#123;</div><div class="line">          z[<span class="number">1</span> - d][j] = z[d][l]</div><div class="line">          l += <span class="number">1</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">          z[<span class="number">1</span> - d][j] = z[d][r]</div><div class="line">          r += <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        j += <span class="number">1</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">while</span> l &lt; lmax &#123;</div><div class="line">        z[<span class="number">1</span> - d][j] = z[d][l]</div><div class="line">        j += <span class="number">1</span></div><div class="line">        l += <span class="number">1</span></div><div class="line">      &#125;</div><div class="line">      <span class="keyword">while</span> r &lt; rmax &#123;</div><div class="line">        z[<span class="number">1</span> - d][j] = z[d][r]</div><div class="line">        j += <span class="number">1</span></div><div class="line">        r += <span class="number">1</span></div><div class="line">      &#125;</div><div class="line"></div><div class="line">      i += width*<span class="number">2</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    width *= <span class="number">2</span></div><div class="line">    d = <span class="number">1</span> - d      <span class="comment">// 5</span></div><div class="line">  &#125;</div><div class="line">  <span class="keyword">return</span> z[d]</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>It looks a lot more intimidating than the top-down version, but notice that the main body includes the same three <code>while</code>loops from <code>merge()</code>.</p>
<p>Notable points:</p>
<ol>
<li>The Merge-sort algorithm needs a temporary working array because you cannot merge the left and right piles and at the same time overwrite their contents. Because allocating a new array for each merge is wasteful, we are using two working arrays, and we will switch between them using the value of <code>d</code>, which is either 0 or 1. The array <code>z[d]</code> is used for reading, and <code>z[1 - d]</code> is used for writing. This is called <em>double-buffering</em>.</li>
<li>Conceptually, the bottom-up version works the same way as the top-down version. First, it merges small piles of one element each, then it merges piles of two elements each, then piles of four elements each, and so on. The size of the pile is given by <code>width</code>. Initially, <code>width</code> is <code>1</code> but at the end of each loop iteration, we multiply it by two, so this outer loop determines the size of the piles being merged, and the subarrays to merge become larger in each step.</li>
<li>The inner loop steps through the piles and merges each pair of piles into a larger one. The result is written in the array given by <code>z[1 - d]</code>.</li>
<li>This is the same logic as in the top-down version. The main difference is that we’re using double-buffering, so values are read from <code>z[d]</code> and written into <code>z[1 - d]</code>. It also uses an <code>isOrderedBefore</code> function to compare the elements rather than just <code>&lt;</code>, so this merge-sort algorithm is generic, and you can use it to sort any kind of object you want.</li>
<li>At this point, the piles of size <code>width</code> from array <code>z[d]</code> have been merged into larger piles of size <code>width * 2</code> in array <code>z[1 - d]</code>. Here, we swap the active array, so that in the next step we’ll read from the new piles we have just created.</li>
</ol>
<p>This function is generic, so you can use it to sort any type you desire, as long as you provide a proper <code>isOrderedBefore</code>closure to compare the elements.</p>
<p>Example of how to use it:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> array = [<span class="number">2</span>, <span class="number">1</span>, <span class="number">5</span>, <span class="number">4</span>, <span class="number">9</span>]</div><div class="line">mergeSortBottomUp(array, &lt;)   <span class="comment">// [1, 2, 4, 5, 9]</span></div></pre></td></tr></table></figure>
<h3 id="Performance-2"><a href="#Performance-2" class="headerlink" title="Performance"></a>Performance</h3><p>The speed of the merge-sort algorithm is dependent on the size of the array it needs to sort. The larger the array, the more work it needs to do.</p>
<p>Whether or not the initial array is sorted already does not affect the speed of the merge-sort algorithm since you will be doing the same amount splits and comparisons regardless of the initial order of the elements.</p>
<p>Therefore, the time complexity for the best, worst, and average case will always be <strong>O(n log n)</strong>.</p>
<p>A disadvantage of the merge-sort algorithm is that it needs a temporary “working” array equal in size to the array being sorted. It is not an <strong>in-place</strong> sort, unlike for example <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Quicksort" target="_blank" rel="external">quicksort</a>.</p>
<p>Most implementations of the merge-sort algorithm produce a <strong>stable</strong> sort. This means that array elements that have identical sort keys will stay in the same order relative to each other after sorting. This is not important for simple values such as numbers or strings, but it can be an issue when sorting more complex objects.</p>
<h2 id="Heap-Sort"><a href="#Heap-Sort" class="headerlink" title="Heap Sort"></a>Heap Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/heapSort.gif" alt="heapSort"></p>
<p><img src="https://www.runoob.com/wp-content/uploads/2019/03/Sorting_heapsort_anim.gif" alt="Sorting_heapsort_anim"></p>
<p>Sorts an array from low to high using a heap.</p>
<p>A <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Heap" target="_blank" rel="external">heap</a> is a partially sorted binary tree that is stored inside an array. The heap sort algorithm takes advantage of the structure of the heap to perform a fast sort.</p>
<p>To sort from lowest to highest, heap sort first converts the unsorted array to a max-heap, so that the first element in the array is the largest.</p>
<p>Let’s say the array to sort is:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 5, 13, 2, 25, 7, 17, 20, 8, 4 ]</div></pre></td></tr></table></figure>
<p>This is first turned into a max-heap that looks like this:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Heap%20Sort/Images/MaxHeap.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Heap%20Sort/Images/MaxHeap.png" alt="The max-heap"></a></p>
<p>The heap’s internal array is then:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 25, 13, 20, 8, 7, 17, 2, 5, 4 ]</div></pre></td></tr></table></figure>
<p>That’s hardly what you’d call sorted! But now the sorting process starts: we swap the first element (index <em>0</em>) with the last one at index <em>n-1</em>, to get:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[ 4, 13, 20, 8, 7, 17, 2, 5, 25 ]</div><div class="line">  *                          *</div></pre></td></tr></table></figure>
<p>Now the new root node, <code>4</code>, will be smaller than its children, so we fix up the max-heap up to element <em>n-2</em> using the <em>shift down</em> or “heapify” procedure. After repairing the heap, the new root is now the second-largest item in the array:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[20, 13, 17, 8, 7, 4, 2, 5 | 25]</div></pre></td></tr></table></figure>
<p>Important: When we fix the heap, we ignore the last item at index <em>n-1</em>. That now contains the array’s maximum value, so it is in its final sorted place already. The <code>|</code> bar indicates where the sorted portion of the array begins. We’ll leave that part of the array alone from now on.</p>
<p>Again, we swap the first element with the last one (this time at index <em>n-2</em>):</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[5, 13, 17, 8, 7, 4, 2, 20 | 25]</div><div class="line"> *                      *</div></pre></td></tr></table></figure>
<p>And fix up the heap to make it valid max-heap again:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[17, 13, 5, 8, 7, 4, 2 | 20, 25]</div></pre></td></tr></table></figure>
<p>As you can see, the largest items are making their way to the back. We repeat this process until we arrive at the root node and then the whole array is sorted.</p>
<blockquote>
<p><strong>Note:</strong> This process is very similar to <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Selection%20Sort" target="_blank" rel="external">selection sort</a>, which repeatedly looks for the minimum item in the remainder of the array. Extracting the minimum or maximum value is what heaps are good at.</p>
</blockquote>
<p>Performance of heap sort is <strong>O(n lg n)</strong> in best, worst, and average case. Because we modify the array directly, heap sort can be performed in-place. But it is not a stable sort: the relative order of identical elements is not preserved.</p>
<p>Here’s how you can implement heap sort in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Heap</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">sort</span><span class="params">()</span></span> -&gt; [<span class="type">T</span>] &#123;</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: (elements.<span class="built_in">count</span> - <span class="number">1</span>), through: <span class="number">1</span>, by: -<span class="number">1</span>) &#123;</div><div class="line">      <span class="built_in">swap</span>(&amp;elements[<span class="number">0</span>], &amp;elements[i])</div><div class="line">      shiftDown(<span class="number">0</span>, heapSize: i)</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> elements</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>This adds a <code>sort()</code> function to our <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Heap" target="_blank" rel="external">heap</a> implementation. To use it, you would do something like this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> h1 = <span class="type">Heap</span>(array: [<span class="number">5</span>, <span class="number">13</span>, <span class="number">2</span>, <span class="number">25</span>, <span class="number">7</span>, <span class="number">17</span>, <span class="number">20</span>, <span class="number">8</span>, <span class="number">4</span>], <span class="built_in">sort</span>: &gt;)</div><div class="line"><span class="keyword">let</span> a1 = h1.<span class="built_in">sort</span>()</div></pre></td></tr></table></figure>
<p>Because we need a max-heap to sort from low-to-high, you need to give <code>Heap</code> the reverse of the sort function. To sort <code>&lt;</code>, the <code>Heap</code> object must be created with <code>&gt;</code> as the sort function. In other words, sorting from low-to-high creates a max-heap and turns it into a min-heap.</p>
<p>We can write a handy helper function for that:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">heapsort</span>&lt;T&gt;<span class="params">(<span class="number">_</span> a: [T], <span class="number">_</span> <span class="built_in">sort</span>: @escaping <span class="params">(T, T)</span></span></span> -&gt; <span class="type">Bool</span>) -&gt; [<span class="type">T</span>] &#123;</div><div class="line">  <span class="keyword">let</span> reverseOrder = &#123; i1, i2 <span class="keyword">in</span> <span class="built_in">sort</span>(i2, i1) &#125;</div><div class="line">  <span class="keyword">var</span> h = <span class="type">Heap</span>(array: a, <span class="built_in">sort</span>: reverseOrder)</div><div class="line">  <span class="keyword">return</span> h.<span class="built_in">sort</span>()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="Hybrid-sorts"><a href="#Hybrid-sorts" class="headerlink" title="Hybrid sorts:"></a>Hybrid sorts:</h1><h2 id="IntroSort"><a href="#IntroSort" class="headerlink" title="IntroSort"></a>IntroSort</h2><p>Goal: Sort an array from low to high (or high to low).</p>
<p>IntroSort is the algorithm used by swift to sort a collection. Introsort is an hybrid algorithm invented by David Musser in 1993 with the purpose of giving a generic sorting algorithm for the C++ standard library. The classic implementation of introsort expect a recursive Quicksort with fallback to Heapsort in case the recursion depth level reached a certain max. The maximum depends on the number of elements in the collection and it is usually 2 <em> log(n). The reason behind this “fallback” is that if Quicksort was not able to get the solution after 2 </em> log(n) recursions for a branch, probably it hit its worst case and it is degrading to complexity O( n^2 ). To optimise even further this algorithm, the swift implementation introduce an extra step in each recursion where the partition is sorted using InsertionSort if the count of the partition is less than 20.</p>
<p>The number 20 is an empiric number obtained observing the behaviour of InsertionSort with lists of this size.</p>
<p>Here’s an implementation in pseudocode:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">procedure <span class="built_in">sort</span>(<span class="type">A</span> : array):</div><div class="line">    <span class="keyword">let</span> maxdepth = ⌊log(length(<span class="type">A</span>))⌋ × <span class="number">2</span></div><div class="line">    introSort(<span class="type">A</span>, maxdepth)</div><div class="line"></div><div class="line">procedure introsort(<span class="type">A</span>, maxdepth):</div><div class="line">    n ← length(<span class="type">A</span>)</div><div class="line">    <span class="keyword">if</span> n &lt; <span class="number">20</span>:</div><div class="line">        insertionsort(<span class="type">A</span>)</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> maxdepth = <span class="number">0</span>:</div><div class="line">        heapsort(<span class="type">A</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        p ← <span class="built_in">partition</span>(<span class="type">A</span>)  <span class="comment">// the pivot is selected using median of 3</span></div><div class="line">        introsort(<span class="type">A</span>[<span class="number">0</span>:p], maxdepth - <span class="number">1</span>)</div><div class="line">        introsort(<span class="type">A</span>[p+<span class="number">1</span>:n], maxdepth - <span class="number">1</span>)</div></pre></td></tr></table></figure>
<h3 id="An-example-5"><a href="#An-example-5" class="headerlink" title="An example"></a>An example</h3><p>Let’s walk through the example. The array is initially:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 10, 0, 3, 9, 2, 14, 8, 27, 1, 5, 8, -1, 26 ]</div></pre></td></tr></table></figure>
<p>For this example let’s assume that <code>maxDepth</code> is <strong>2</strong> and that the size of the partition for the insertionSort to kick in is <strong>5</strong></p>
<p>The first iteration of introsort begins by attempting to use insertionSort. The collection has 13 elements, so it tries to do heapsort instead. The condition for heapsort to occur is if <code>maxdepth == 0</code> evaluates true. Since <code>maxdepth</code> is currently <strong>2</strong>for the first iteration, introsort will default to quicksort.</p>
<p>The <code>partition</code> method picks the first element, the median and the last, it sorts them and uses the new median as pivot.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 10, 8, 26 ] -&gt; [ 8, 10, 26 ]</div></pre></td></tr></table></figure>
<p>Our array is now</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 8, 0, 3, 9, 2, 14, 10, 27, 1, 5, 8, -1, 26 ]</div></pre></td></tr></table></figure>
<p><strong>10</strong> is the pivot. After the choice of the pivot, the <code>partition</code> method swaps elements to get all the elements less than pivot on the left, and all the elements more or equal than pivot on the right.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 8, 0, 3, 9, 2, 1, 5, 8, -1, 10, 27, 14, 26 ]</div></pre></td></tr></table></figure>
<p>Because of the swaps, the index of of pivot is now changed and returned. The next step of introsort is to call recursively itself for the two sub arrays:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">less: [ 8, 0, 3, 9, 2, 1, 5, 8, -1, 10 ]</div><div class="line">greater: [ 27, 14, 26 ]</div></pre></td></tr></table></figure>
<h3 id="maxDepth-1-branch-less"><a href="#maxDepth-1-branch-less" class="headerlink" title="maxDepth: 1, branch: less"></a>maxDepth: 1, branch: less</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 8, 0, 3, 9, 2, 1, 5, 8, -1, 10 ]</div></pre></td></tr></table></figure>
<p>The count of the array is still more than 5 so we don’t meet yet the conditions for insertion sort to kick in. At this iteration maxDepth is decreased by one but it is still more than zero, so heapsort will not act.</p>
<p>Just like in the previous iteration quicksort wins and the <code>partition</code> method choses a pivot and sorts the elemets less than pivot on the left and the elements more or equeal than pivot on the right.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">array: [ 8, 0, 3, 9, 2, 1, 5, 8, -1, 10 ]</div><div class="line">pivot candidates: [ 8, 1, 10] -&gt; [ 1, 8, 10]</div><div class="line">pivot: 8</div><div class="line">before partition: [ 1, 0, 3, 9, 2, 8, 5, 8, -1, 10 ]</div><div class="line">after partition: [ 1, 0, 3, -1, 2, 5, 8, 8, 9, 10 ]</div><div class="line"></div><div class="line">less: [ 1, 0, 3, -1, 2, 5, 8 ]</div><div class="line">greater: [ 8, 9, 10 ]</div></pre></td></tr></table></figure>
<h3 id="maxDepth-0-branch-less"><a href="#maxDepth-0-branch-less" class="headerlink" title="maxDepth: 0, branch: less"></a>maxDepth: 0, branch: less</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 1, 0, 3, -1, 2, 5, 8 ]</div></pre></td></tr></table></figure>
<p>Just like before, introsort is recursively executed for <code>less</code> and greater. This time <code>less</code>has a count more than <strong>5</strong> so it will not be sorted with insertion sort, but the maxDepth decreased again by 1 is now 0 and heapsort takes over sorting the array.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">heapsort -&gt; [ -1, 0, 1, 2, 3, 5, 8 ]</div></pre></td></tr></table></figure>
<h3 id="maxDepth-0-branch-greater"><a href="#maxDepth-0-branch-greater" class="headerlink" title="maxDepth: 0, branch: greater"></a>maxDepth: 0, branch: greater</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 8, 9, 10 ]</div></pre></td></tr></table></figure>
<p>following greater in this recursion, the count of elements is 3, which is less than 5, so this partition is sorted using insertionSort.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">insertionSort -&gt; [ 8, 9 , 10]</div></pre></td></tr></table></figure>
<h3 id="back-to-maxDepth-1-branch-greater"><a href="#back-to-maxDepth-1-branch-greater" class="headerlink" title="back to maxDepth = 1, branch: greater"></a>back to maxDepth = 1, branch: greater</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ 27, 14, 26 ]</div></pre></td></tr></table></figure>
<p>At this point the original array has mutated to be</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 0, 1, 2, 3, 5, 8, 8, 9, 10, 27, 14, 26 ]</div></pre></td></tr></table></figure>
<p>now the <code>less</code> partition is sorted and since the count of the <code>greater</code> partition is 3 it will be sorted with insertion sort <code>[ 14, 26, 27 ]</code></p>
<p>The array is now successfully sorted</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[ -1, 0, 1, 2, 3, 5, 8, 8, 9, 10, 14, 26, 27 ]</div></pre></td></tr></table></figure>
<h1 id="Special-purpose-sorts"><a href="#Special-purpose-sorts" class="headerlink" title="Special-purpose sorts:"></a>Special-purpose sorts:</h1><h2 id="Counting-Sort"><a href="#Counting-Sort" class="headerlink" title="Counting Sort"></a>Counting Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/countingSort.gif" alt="countingSort"></p>
<p>Counting sort is an algorithm for sorting a collection of objects according to keys that are small integers. It operates by counting the number of objects that have each distinct key values, and using arithmetic on those counts to determine the positions of each key value in the output sequence.</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>To understand the algorithm let’s walk through a small example.</p>
<p>Consider the array: <code>[ 10, 9, 8, 7, 1, 2, 7, 3 ]</code></p>
<h4 id="Step-1"><a href="#Step-1" class="headerlink" title="Step 1:"></a>Step 1:</h4><p>The first step is to count the total number of occurrences for each item in the array. The output for the first step would be a new array that looks as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Index 0 1 2 3 4 5 6 7 8 9 10</div><div class="line">Count 0 1 1 1 0 0 0 2 1 1 1</div></pre></td></tr></table></figure>
<p>Here is the code to accomplish this:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="built_in">maxElement</span> = array.<span class="built_in">max</span>() ?? <span class="number">0</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> countArray = [<span class="type">Int</span>](repeating: <span class="number">0</span>, <span class="built_in">count</span>: <span class="type">Int</span>(<span class="built_in">maxElement</span> + <span class="number">1</span>))</div><div class="line"><span class="keyword">for</span> element <span class="keyword">in</span> array &#123;</div><div class="line">  countArray[element] += <span class="number">1</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Step-2"><a href="#Step-2" class="headerlink" title="Step 2:"></a>Step 2:</h4><p>In this step the algorithm tries to determine the number of elements that are placed before each element. Since, you already know the total occurrences for each element you can use this information to your advantage. The way it works is to sum up the previous counts and store them at each index.</p>
<p>The count array would be as follows:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Index 0 1 2 3 4 5 6 7 8 9 10</div><div class="line">Count 0 1 2 3 3 3 3 5 6 7 8</div></pre></td></tr></table></figure>
<p>The code for step 2 is:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> index <span class="keyword">in</span> <span class="number">1</span> ..&lt; countArray.<span class="built_in">count</span> &#123;</div><div class="line">  <span class="keyword">let</span> sum = countArray[index] + countArray[index - <span class="number">1</span>]</div><div class="line">  countArray[index] = sum</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Step-3"><a href="#Step-3" class="headerlink" title="Step 3:"></a>Step 3:</h4><p>This is the last step in the algorithm. Each element in the original array is placed at the position defined by the output of step 2. For example, the number 10 would be placed at an index of 7 in the output array. Also, as you place the elements you need to reduce the count by 1 as those many elements are reduced from the array.</p>
<p>The final output would be:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Index  0 1 2 3 4 5 6 7</div><div class="line">Output 1 2 3 7 7 8 9 10</div></pre></td></tr></table></figure>
<p>Here is the code for this final step:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> sortedArray = [<span class="type">Int</span>](repeating: <span class="number">0</span>, <span class="built_in">count</span>: array.<span class="built_in">count</span>)</div><div class="line"><span class="keyword">for</span> element <span class="keyword">in</span> array &#123;</div><div class="line">  countArray[element] -= <span class="number">1</span></div><div class="line">  sortedArray[countArray[element]] = element</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> sortedArray</div></pre></td></tr></table></figure>
<h3 id="Performance-3"><a href="#Performance-3" class="headerlink" title="Performance"></a>Performance</h3><p>The algorithm uses simple loops to sort a collection. Hence, the time to run the entire algorithm is <strong>O(n+k)</strong> where <strong>O(n)</strong>represents the loops that are required to initialize the output arrays and <strong>O(k)</strong> is the loop required to create the count array.</p>
<p>The algorithm uses arrays of length <strong>n + 1</strong> and <strong>n</strong>, so the total space required is <strong>O(2n)</strong>. Hence for collections where the keys are scattered in a dense area along the number line it can be space efficient.</p>
<h2 id="Radix-Sort"><a href="#Radix-Sort" class="headerlink" title="Radix Sort"></a>Radix Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/radixSort.gif" alt="radixSort"></p>
<p>Radix sort is a sorting algorithm that takes as input an array of integers and uses a sorting subroutine( that is often another efficient sorting algorith) to sort the integers by their radix, or rather their digit. Counting Sort, and Bucket Sort are often times used as the subroutine for Radix Sort.</p>
<h3 id="Example-1"><a href="#Example-1" class="headerlink" title="Example"></a>Example</h3><ul>
<li>Input Array: [170, 45, 75, 90, 802, 24, 2, 66]</li>
<li>Output Array (Sorted): [2, 24, 45, 66, 75, 90, 170, 802]</li>
</ul>
<h4 id="Step-1-1"><a href="#Step-1-1" class="headerlink" title="Step 1:"></a>Step 1:</h4><p>The first step in this algorithm is to define the digit or rather the “base” or radix that we will use to sort. For this example we will let radix = 10, since the integers we are working with in the example are of base 10.</p>
<h4 id="Step-2-1"><a href="#Step-2-1" class="headerlink" title="Step 2:"></a>Step 2:</h4><p>The next step is to simply iterate n times (where n is the number of digits in the largest integer in the input array), and upon each iteration perform a sorting subroutine on the current digit in question.</p>
<h4 id="Algorithm-in-Action"><a href="#Algorithm-in-Action" class="headerlink" title="Algorithm in Action"></a>Algorithm in Action</h4><p>Let’s take a look at our example input array.</p>
<p>The largest integer in our array is 802, and it has three digits (ones, tens, hundreds). So our algorithm will iterate three times whilst performing some sorting algorithm on the digits of each integer.</p>
<ul>
<li>Iteration 1: 170, 90, 802, 2, 24, 45, 75, 66</li>
<li>Iteration 2: 802, 2, 24, 45, 66, 170, 75, 90</li>
<li>Iteration 3: 2, 24, 45, 66, 75, 90, 170, 802</li>
</ul>
<h2 id="Topological-Sort"><a href="#Topological-Sort" class="headerlink" title="Topological Sort"></a>Topological Sort</h2><p>Topological sort is an algorithm that orders a directed graph such that for each directed edge <em>u→v</em>, vertex <em>u</em> comes before vertex <em>v</em>.</p>
<p>In other words, a topological sort places the vertices of a <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Graph" target="_blank" rel="external">directed acyclic graph</a> on a line so that all directed edges go from left to right.</p>
<p>Consider the graph in the following example:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/Graph.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Graph.png" alt="Example"></a></p>
<p>This graph has two possible topological sorts:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/TopologicalSort.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/TopologicalSort.png" alt="Example"></a></p>
<p>The topological orderings are <strong>S, V, W, T, X</strong> and <strong>S, W, V, T, X</strong>. Notice how the arrows all go from left to right.</p>
<p>The following is not a valid topological sort for this graph, since <strong>X</strong> and <strong>T</strong> cannot happen before <strong>V</strong>:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/InvalidSort.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/InvalidSort.png" alt="Example"></a></p>
<h3 id="Where-is-this-used"><a href="#Where-is-this-used" class="headerlink" title="Where is this used?"></a>Where is this used?</h3><p>Let’s consider that you want to learn all the algorithms and data structures from the Swift Algorithm Club. This might seem daunting at first but we can use topological sort to get things organized.</p>
<p>Since you’re learning about topological sort, let’s take this topic as an example. What else do you need to learn first before you can fully understand topological sort? Well, topological sort uses <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Depth-First%20Search" target="_blank" rel="external">depth-first search</a> as well as a <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Stack" target="_blank" rel="external">stack</a>. But before you can learn about the depth-first search algorithm, you need to know what a <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Graph" target="_blank" rel="external">graph</a> is, and it helps to know what a <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Tree" target="_blank" rel="external">tree</a> is. In turn, graphs and trees use the idea of linking objects together, so you may need to read up on that first. And so on…</p>
<p>If we were to represent these objectives in the form of a graph it would look as follows:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/Algorithms.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Algorithms.png" alt="Example"></a></p>
<p>If we consider each algorithm to be a vertex in the graph you can clearly see the dependencies between them. To learn something you might have to know something else first. This is exactly what topological sort is used for – it will sort things out so that you know what to do first.</p>
<h3 id="How-does-it-work"><a href="#How-does-it-work" class="headerlink" title="How does it work?"></a>How does it work?</h3><p><strong>Step 1: Find all vertices that have in-degree of 0</strong></p>
<p>The <em>in-degree</em> of a vertex is the number of edges pointing at that vertex. Vertices with no incoming edges have an in-degree of 0. These vertices are the starting points for the topological sort.</p>
<p>In the context of the previous example, these starting vertices represent algorithms and data structures that don’t have any prerequisites; you don’t need to learn anything else first, hence the sort starts with them.</p>
<p><strong>Step 2: Traverse the graph with depth-first search</strong></p>
<p>Depth-first search is an algorithm that starts traversing the graph from a certain vertex and explores as far as possible along each branch before backtracking. To find out more about depth-first search, please take a look at the <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Depth-First%20Search" target="_blank" rel="external">detailed explanation</a>.</p>
<p>We perform a depth-first search on each vertex with in-degree 0. This tells us which vertices are connected to each of these starting vertices.</p>
<p><strong>Step 3: Remember all visited vertices</strong></p>
<p>As we perform the depth-first search, we maintain a list of all the vertices that have been visited. This is to avoid visiting the same vertex twice.</p>
<p><strong>Step 4: Put it all together</strong></p>
<p>The last step of the sort is to combine the results of the different depth-first searches and put the vertices in a sorted list.</p>
<h3 id="Example-2"><a href="#Example-2" class="headerlink" title="Example"></a>Example</h3><p>Consider the following graph:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/Example.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/Example.png" alt="Graph Example"></a></p>
<p><strong>Step 1:</strong> The vertices with 0 in-degree are: <strong>3, 7, 5</strong>. These are our starting vertices.</p>
<p><strong>Step 2:</strong> Perform depth-first search for each starting vertex, without remembering vertices that have already been visited:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Vertex 3: 3, 10, 8, 9</div><div class="line">Vertex 7: 7, 11, 2, 8, 9</div><div class="line">Vertex 5: 5, 11, 2, 9, 10</div></pre></td></tr></table></figure>
<p><strong>Step 3:</strong> Filter out the vertices already visited in each previous search:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Vertex 3: 3, 10, 8, 9</div><div class="line">Vertex 7: 7, 11, 2</div><div class="line">Vertex 5: 5</div></pre></td></tr></table></figure>
<p><strong>Step 4:</strong> Combine the results of these three depth-first searches. The final sorted order is <strong>5, 7, 11, 2, 3, 10, 8, 9</strong>. (Important: we need to add the results of each subsequent search to the <em>front</em> of the sorted list.)</p>
<p>The result of the topological sort looks like this:</p>
<p><a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/Images/GraphResult.png" target="_blank" rel="external"><img src="https://github.com/raywenderlich/swift-algorithm-club/raw/master/Topological%20Sort/Images/GraphResult.png" alt="Result of the sort"></a></p>
<blockquote>
<p><strong>Note:</strong> This is not the only possible topological sort for this graph. For example, other valid solutions are <strong>3, 7, 5, 10, 8, 11, 9, 2</strong> and <strong>3, 7, 5, 8, 11, 2, 9, 10</strong>. Any order where all the arrows are going from left to right will do.</p>
</blockquote>
<h3 id="The-code-2"><a href="#The-code-2" class="headerlink" title="The code"></a>The code</h3><p>Here is how you could implement topological sort in Swift (see also <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/TopologicalSort1.swift" target="_blank" rel="external">TopologicalSort1.swift</a>):</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">Graph</span> </span>&#123;</div><div class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">topologicalSort</span><span class="params">()</span></span> -&gt; [<span class="type">Node</span>] &#123;</div><div class="line">    <span class="comment">// 1</span></div><div class="line">    <span class="keyword">let</span> startNodes = calculateInDegreeOfNodes().<span class="built_in">filter</span>(&#123; <span class="number">_</span>, indegree <span class="keyword">in</span></div><div class="line">      <span class="keyword">return</span> indegree == <span class="number">0</span></div><div class="line">    &#125;).<span class="built_in">map</span>(&#123; node, indegree <span class="keyword">in</span></div><div class="line">      <span class="keyword">return</span> node</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    <span class="comment">// 2</span></div><div class="line">    <span class="keyword">var</span> visited = [<span class="type">Node</span> : <span class="type">Bool</span>]()</div><div class="line">    <span class="keyword">for</span> (node, <span class="number">_</span>) <span class="keyword">in</span> adjacencyLists &#123;</div><div class="line">      visited[node] = <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// 3</span></div><div class="line">    <span class="keyword">var</span> result = [<span class="type">Node</span>]()</div><div class="line">    <span class="keyword">for</span> startNode <span class="keyword">in</span> startNodes &#123;</div><div class="line">      result = depthFirstSearch(startNode, visited: &amp;visited) + result</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">// 4    </span></div><div class="line">    <span class="keyword">return</span> result</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Some remarks:</p>
<ol>
<li>Find the in-degree of each vertex and put all the vertices with in-degree 0 in the <code>startNodes</code> array. In this graph implementation, vertices are called “nodes”. Both terms are used interchangeably by people who write graph code.</li>
<li>The <code>visited</code> array keeps track of whether we’ve already seen a vertex during the depth-first search. Initially, we set all elements to <code>false</code>.</li>
<li>For each of the vertices in the <code>startNodes</code> array, perform a depth-first search. This returns an array of sorted <code>Node</code>objects. We prepend that array to our own <code>result</code> array.</li>
<li>The <code>result</code> array contains all the vertices in topologically sorted order.</li>
</ol>
<blockquote>
<p><strong>Note:</strong> For a slightly different implementation of topological sort using depth-first search, see <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/TopologicalSort3.swift" target="_blank" rel="external">TopologicalSort3.swift</a>. This uses a stack and does not require you to find all vertices with in-degree 0 first.</p>
</blockquote>
<h3 id="Kahn’s-algorithm"><a href="#Kahn’s-algorithm" class="headerlink" title="Kahn’s algorithm"></a>Kahn’s algorithm</h3><p>Even though depth-first search is the typical way to perform a topological sort, there is another algorithm that also does the job.</p>
<ol>
<li>Find out what the in-degree is of every vertex.</li>
<li>Put all the vertices that have no predecessors in a new array called <code>leaders</code>. These vertices have in-degree 0 and therefore do not depend on any other vertices.</li>
<li>Go through this list of leaders and remove them one-by-one from the graph. We don’t actually modify the graph, we just decrement the in-degree of the vertices they point to. That has the same effect.</li>
<li>Look at the (former) immediate neighbor vertices of each leader. If any of them now have an in-degree of 0, then they no longer have any predecessors themselves. We’ll add those vertices to the <code>leaders</code> array too.</li>
<li>This repeats until there are no more vertices left to look at. At this point, the <code>leaders</code> array contains all the vertices in sorted order.</li>
</ol>
<p>This is an <strong>O(n + m)</strong> algorithm where <strong>n</strong> is the number of vertices and <strong>m</strong> is the number of edges. You can see the implementation in <a href="https://github.com/raywenderlich/swift-algorithm-club/blob/master/Topological%20Sort/TopologicalSort2.swift" target="_blank" rel="external">TopologicalSort2.swift</a>.</p>
<h1 id="Bad-sorting-algorithms-don’t-use-these"><a href="#Bad-sorting-algorithms-don’t-use-these" class="headerlink" title="Bad sorting algorithms (don’t use these!):"></a>Bad sorting algorithms (don’t use these!):</h1><h2 id="Bubble-Sort"><a href="#Bubble-Sort" class="headerlink" title="Bubble Sort"></a>Bubble Sort</h2><p><img src="https://www.runoob.com/wp-content/uploads/2019/03/bubbleSort.gif" alt="bubbleSort"></p>
<p>Bubble sort is a sorting algorithm that is implemented by starting in the beginning of the array and swapping the first two elements only if the first element is greater than the second element. This comparison is then moved onto the next pair and so on and so forth. This is done until the array is completely sorted. The smaller items slowly “bubble” up to the beginning of the array. Sometimes this algorithm is refered as Sinking sort, due to the larger, or heavier elements sinking to the end of the array.</p>
<h3 id="Runtime"><a href="#Runtime" class="headerlink" title="Runtime:"></a>Runtime:</h3><ul>
<li>Average: O(N^2)</li>
<li>Worst: O(N^2)</li>
</ul>
<h3 id="Memory"><a href="#Memory" class="headerlink" title="Memory:"></a>Memory:</h3><ul>
<li>O(1)</li>
</ul>
<h3 id="Implementation"><a href="#Implementation" class="headerlink" title="Implementation:"></a>Implementation:</h3><p>The implementation will not be shown as the average and worst runtimes show that this is a very inefficient algorithm. However, having a grasp of the concept will help you understand the basics of simple sorting algorithms.</p>
<p>Bubble sort is a very simple sorting algorithm, it consists in comparing pairs of adjacent elements in the array, if the first element is larger, swap them, otherwise, you do nothing and go for the next comparison. This is accomplished by looking through the array <code>n</code> times, <code>n</code> being the amount of elements in the array.</p>
<h4 id="Example-3"><a href="#Example-3" class="headerlink" title="Example"></a>Example</h4><p>Let us take the array <code>[5, 1, 4, 2, 8]</code>, and sort the array from lowest number to greatest number using bubble sort. In each step, elements written in bold are being compared. Three passes will be required.</p>
<h5 id="First-Pass"><a href="#First-Pass" class="headerlink" title="First Pass"></a>First Pass</h5><p>[ <strong>5 1</strong> 4 2 8 ] -&gt; [ <strong>1 5</strong> 4 2 8 ], Here, algorithm compares the first two elements, and swaps since 5 &gt; 1.</p>
<p>[ 1 <strong>5 4</strong> 2 8 ] -&gt; [ 1 <strong>4 5</strong> 2 8 ], Swap since 5 &gt; 4</p>
<p>[ 1 4 <strong>5 2</strong> 8 ] -&gt; [ 1 4 <strong>2 5</strong> 8 ], Swap since 5 &gt; 2</p>
<p>[ 1 4 2 <strong>5 8</strong> ] -&gt; [ 1 4 2 <strong>5 8</strong> ], Now, since these elements are already in order (8 &gt; 5), algorithm does not swap them.</p>
<h5 id="Second-Pass"><a href="#Second-Pass" class="headerlink" title="Second Pass"></a>Second Pass</h5><p>[ <strong>1 4</strong> 2 5 8 ] -&gt; [ <strong>1 4</strong> 2 5 8 ]</p>
<p>[ 1 <strong>4 2</strong> 5 8 ] -&gt; [ 1 <strong>2 4</strong> 5 8 ], Swap since 4 &gt; 2</p>
<p>[ 1 2 <strong>4 5</strong> 8 ] -&gt; [ 1 2 <strong>4 5</strong> 8 ]</p>
<p>[ 1 2 4 <strong>5 8</strong> ] -&gt; [ 1 2 4 <strong>5 8</strong> ] Now, the array is already sorted, but the algorithm does not know if it is completed. The algorithm needs one whole pass without any swap to know it is sorted.</p>
<h5 id="Third-Pass"><a href="#Third-Pass" class="headerlink" title="Third Pass"></a>Third Pass</h5><p>[ <strong>1 2</strong> 4 5 8 ] -&gt; [ <strong>1 2</strong> 4 5 8 ]</p>
<p>[ 1 <strong>2 4</strong> 5 8 ] -&gt; [ 1 <strong>2 4</strong> 5 8 ]</p>
<p>[ 1 2 <strong>4 5</strong> 8 ] -&gt; [ 1 2 <strong>4 5</strong> 8 ]</p>
<p>[ 1 2 4 <strong>5 8</strong> ] -&gt; [ 1 2 4 <strong>5 8</strong> ]</p>
<p>This is the same for the forth and fifth passes.</p>
<h4 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h4><figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;array.<span class="built_in">count</span> &#123;</div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">1</span>..&lt;array.<span class="built_in">count</span> &#123;</div><div class="line">    <span class="keyword">if</span> array[j] &lt; array[j-<span class="number">1</span>] &#123;</div><div class="line">      <span class="keyword">let</span> tmp = array[j-<span class="number">1</span>]</div><div class="line">      array[j-<span class="number">1</span>] = array[j]</div><div class="line">      array[j] = tmp</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> array</div></pre></td></tr></table></figure>
<h4 id="Optimization"><a href="#Optimization" class="headerlink" title="Optimization"></a>Optimization</h4><p>The bubble sort algorithm can be easily optimized by observing that the <code>n-th</code> pass finds the <code>n-th</code> largest element and puts it into its final place. So, the inner loop can avoid looking at the last <code>n-1</code> items when running for the <code>n-th</code> time:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;array.<span class="built_in">count</span> &#123;</div><div class="line">  <span class="keyword">for</span> j <span class="keyword">in</span> <span class="number">1</span>..&lt;array.<span class="built_in">count</span> - i &#123;</div><div class="line">    <span class="keyword">if</span> array[j] &lt; array[j-<span class="number">1</span>] &#123;</div><div class="line">      <span class="keyword">let</span> tmp = array[j-<span class="number">1</span>]</div><div class="line">      array[j-<span class="number">1</span>] = array[j]</div><div class="line">      array[j] = tmp</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">return</span> array</div></pre></td></tr></table></figure>
<p>The only change made was on the second line, changing the interval from <code>1..&lt;array.count</code> to <code>1..&lt;array.count - i</code>, effectively cutting the number of comparisons by half.</p>
<p>The ordering with the optimized code would look something like this for the array <code>[5, 1, 4, 2, 8]</code>:</p>
<h5 id="First-Pass-1"><a href="#First-Pass-1" class="headerlink" title="First Pass"></a>First Pass</h5><p>[ <strong>5 1</strong> 4 2 8 ] -&gt; [ <strong>1 5</strong> 4 2 8 ], Swaps since 5 &gt; 1</p>
<p>[ 1 <strong>5 4</strong> 2 8 ] -&gt; [ 1 <strong>4 5</strong> 2 8 ], Swap since 5 &gt; 4</p>
<p>[ 1 4 <strong>5 2</strong> 8 ] -&gt; [ 1 4 <strong>2 5</strong> 8 ], Swap since 5 &gt; 2</p>
<p>[ 1 4 2 <strong>5 8</strong> ] -&gt; [ 1 4 2 <strong>5 8</strong> ], Now, since these elements are already in order (8 &gt; 5), algorithm does not swap them.</p>
<p><em>by the end of the first pass, the last element is guaranteed to be the largest</em></p>
<h5 id="Second-Pass-1"><a href="#Second-Pass-1" class="headerlink" title="Second Pass"></a>Second Pass</h5><p>[ <strong>1 4</strong> 2 5 8 ] -&gt; [ <strong>1 4</strong> 2 5 8 ]</p>
<p>[ 1 <strong>4 2</strong> 5 8 ] -&gt; [ 1 <strong>2 4</strong> 5 8 ], Swap since 4 &gt; 2</p>
<p>[ 1 2 <strong>4 5</strong> 8 ] -&gt; [ 1 2 <strong>4 5</strong> 8 ], As the first loop has occured once, the inner loop stops here, not comparing 5 with 8</p>
<h5 id="Third-Pass-1"><a href="#Third-Pass-1" class="headerlink" title="Third Pass"></a>Third Pass</h5><p>[ <strong>1 2</strong> 4 5 8 ] -&gt; [ <strong>1 2</strong> 4 5 8 ]</p>
<p>[ 1 <strong>2 4</strong> 5 8 ] -&gt; [ 1 <strong>2 4</strong> 5 8 ] again, stoping one comparison short</p>
<h5 id="Fourth-Pass"><a href="#Fourth-Pass" class="headerlink" title="Fourth Pass"></a>Fourth Pass</h5><p>[ <strong>1 2</strong> 4 5 8 ] -&gt; [ <strong>1 2</strong> 4 5 8 ]</p>
<p>There is no Fifth pass</p>
<h4 id="Conclusion"><a href="#Conclusion" class="headerlink" title="Conclusion"></a>Conclusion</h4><p>Even with the proposed optimizations, this is still a terribly inefficient sorting algorithm. A good alternative is <a href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Merge%20Sort" target="_blank" rel="external">Merge Sort</a>, that not only is better performing, has a similar degree of dificulty to implement.</p>
<h2 id="Slow-Sort"><a href="#Slow-Sort" class="headerlink" title="Slow Sort"></a>Slow Sort</h2><p>Goal: Sort an array of numbers from low to high (or high to low).</p>
<p>You are given an array of numbers and need to put them in the right order. The insertion sort algorithm works as follows:</p>
<p>We can decompose the problem of sorting n numbers in ascending order into</p>
<ol>
<li>find the maximum of the numbers</li>
<li>find the maximum of the first n/2 elements</li>
<li>find the maximum of the remaining n/2 elements</li>
<li>find the largest of those two maxima</li>
<li>sorting the remaining ones</li>
</ol>
<h3 id="The-code-3"><a href="#The-code-3" class="headerlink" title="The code"></a>The code</h3><p>Here is an implementation of slow sort in Swift:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">func</span> <span class="title">slowsort</span><span class="params">(<span class="number">_</span> i: Int, <span class="number">_</span> j: Int)</span></span> &#123;</div><div class="line">    <span class="keyword">if</span> i&gt;=j &#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> m = (i+j)/<span class="number">2</span></div><div class="line">    slowsort(i,m)</div><div class="line">    slowsort(m+<span class="number">1</span>,j)</div><div class="line">    <span class="keyword">if</span> numberList[j] &lt; numberList[m] &#123;</div><div class="line">        <span class="keyword">let</span> temp = numberList[j]</div><div class="line">        numberList[j] = numberList[m]</div><div class="line">        numberList[m] = temp</div><div class="line">    &#125;</div><div class="line">    slowsort(i,j-<span class="number">1</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="Performance-4"><a href="#Performance-4" class="headerlink" title="Performance"></a>Performance</h3><p><strong>WORST!</strong></p>
<h3 id="See-also"><a href="#See-also" class="headerlink" title="See also"></a>See also</h3><p><a href="http://c2.com/cgi/wiki?SlowSort" target="_blank" rel="external">Slow Sort explanation in the Internet</a></p>
<h1 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h1><p><a href="https://github.com/raywenderlich/swift-algorithm-club/tree/master/Slow%20Sort" target="_blank" rel="external">swift-algorithm-club</a></p>
<p><a href="https://www.runoob.com/w3cnote/ten-sorting-algorithm.html" target="_blank" rel="external">Top 10 classic sorting algorithms</a></p>
<p><a href="Algorithmic Art and Informatics Competition"><strong>算法艺术与信息学竞赛（刘汝佳、黄亮）</strong></a></p>

      
    </div>
    
    
    
    <div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  <!-- JS库 sweetalert 可修改路径 -->
  <script type="text/javascript" src="http://jslibs.wuxubj.cn/sweetalert_mini/jquery-1.7.1.min.js"></script>
  <script src="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.min.js"></script>
  <link rel="stylesheet" type="text/css" href="http://jslibs.wuxubj.cn/sweetalert_mini/sweetalert.mini.css">
  <p><span>Title:  </span>Several sorting algorithms</a></p>
  <p><span>Author:  </span>Tuski</a></p>
  <p><span>Published:  </span>06/18/2019 - 16:02:42</p>
  <p><span>Updated:  </span>06/19/2019 - 20:37:54</p>
  <p><span>Link:  </span><a href="/2019/06/Several-sorting-algorithms/" title="Several sorting algorithms">http://www.perphet.com/2019/06/Several-sorting-algorithms/</a>
    <span class="copy-path"  title="Click to Copy article link"><i class="fa fa-clipboard" data-clipboard-text="http://www.perphet.com/2019/06/Several-sorting-algorithms/"  aria-label="Copy successfully！"></i></span>
  </p>
  <p><span>Protocol:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)</a> Reprinted please keep the original link and author</p>  
</div>
<script>
    var clipboard = new Clipboard('.fa-clipboard');
    clipboard.on('success', $(function(){
      $(".fa-clipboard").click(function(){
        swal({   
          title: "",   
          text: 'Copy successfully！',   
          html: false,
          timer: 500,   
          showConfirmButton: false
        });
      });
    }));  
</script>

      
    </div>

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Thx F Sup</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="https://i.loli.net/2017/12/16/5a33fd668ce7c.png" alt="Tuski WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="https://i.loli.net/2017/12/16/5a33fdbe62e6f.png" alt="Tuski Alipay"/>
        <p>Alipay</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Swift/" rel="tag"><i class="fa fa-tag"></i> Swift</a>
          
            <a href="/tags/Algorithm/" rel="tag"><i class="fa fa-tag"></i> Algorithm</a>
          
        </div>
      

      
      
        <div class="post-widgets">
        
          <div class="wp_rating">
         
            <div id="wpac-rating"></div>
          </div>
        

        
        </div>
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/04/Swift-中的字符串是如何比较的？/" rel="next" title="Swift 中的字符串是如何比较的？">
                <i class="fa fa-chevron-left"></i> Swift 中的字符串是如何比较的？
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/08/OC-Runtime/" rel="prev" title="OC Runtime">
                OC Runtime <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        <!-- Go to www.addthis.com/dashboard to customize your tools -->
<div class="addthis_inline_share_toolbox">
  <script type = "text/javascript" src = "//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5a35fec5ad889f1e" async = "async" ></script>
</div>

      
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
      <div id="hypercomments_widget"></div>
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.png"
                alt="Tuski" />
            
              <p class="site-author-name" itemprop="name">Tuski</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">47</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">40</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/thevenomsnake" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="mailto:thevenomsnake@icloud.com" target="_blank" title="E-Mail">
                    
                      <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://plus.google.com/u/0/104624402456467592306" target="_blank" title="Google">
                    
                      <i class="fa fa-fw fa-google"></i>Google</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/perphet" target="_blank" title="Twitter">
                    
                      <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.youtube.com/channel/UComQu3jg43YgIvm2PqAG1tA" target="_blank" title="YouTube">
                    
                      <i class="fa fa-fw fa-youtube"></i>YouTube</a>
                </span>
              
            
          </div>

          
          


  <div class="links-of-blogroll motion-element links-of-blogroll-block">
    <div class="links-of-blogroll-title">
      <i class="fa  fa-fw fa-globe"></i>
      Links&nbsp;
      <i class="fa  fa-fw fa-globe"></i>
    </div>
    <ul class="links-of-blogroll-list">
      
        <li class="links-of-blogroll-item">
          <a href="https://blog.crazyforcode.org/" title="CFC" target="_blank">CFC</a>
        </li>
      
    </ul>
     
  </div>
 

          
      <iframe src="https://open.spotify.com/embed?uri=spotify:user:spotify:playlist:37i9dQZF1DXcBWIGoYBM5M&theme=white" width="215" height="350" frameborder="0" allowtransparency="true"></iframe>
       
      </section>


      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Overview"><span class="nav-text">Overview</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Classification"><span class="nav-text">Classification</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Algorithm-complexity"><span class="nav-text">Algorithm complexity</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Basic-sorts"><span class="nav-text">Basic sorts:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Insertion-Sort"><span class="nav-text">Insertion Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example"><span class="nav-text">An example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#In-place-sort"><span class="nav-text">In-place sort</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-to-insert"><span class="nav-text">How to insert</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-code"><span class="nav-text">The code</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#No-more-swaps"><span class="nav-text">No more swaps</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Making-it-generic"><span class="nav-text">Making it generic</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance"><span class="nav-text">Performance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Selection-Sort"><span class="nav-text">Selection Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example-1"><span class="nav-text">An example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-code-1"><span class="nav-text">The code</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-1"><span class="nav-text">Performance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Shell-Sort"><span class="nav-text">Shell Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#How-it-works"><span class="nav-text">How it works</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example-2"><span class="nav-text">An example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-gap-sequence"><span class="nav-text">The gap sequence</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Just-for-fun…"><span class="nav-text">Just for fun…</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-Code"><span class="nav-text">The Code:</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Fast-sorts"><span class="nav-text">Fast sorts:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Quicksort"><span class="nav-text">Quicksort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example-3"><span class="nav-text">An example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Partitioning"><span class="nav-text">Partitioning</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Lomuto’s-partitioning-scheme"><span class="nav-text">Lomuto’s partitioning scheme</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Hoare’s-partitioning-scheme"><span class="nav-text">Hoare’s partitioning scheme</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Picking-a-good-pivot"><span class="nav-text">Picking a good pivot</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Dutch-national-flag-🇳🇱-partitioning"><span class="nav-text">Dutch national flag 🇳🇱 partitioning</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Merge-Sort"><span class="nav-text">Merge Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example-4"><span class="nav-text">An example</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Splitting"><span class="nav-text">Splitting</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Merging"><span class="nav-text">Merging</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Top-down-implementation"><span class="nav-text">Top-down implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Bottom-up-implementation"><span class="nav-text">Bottom-up implementation</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-2"><span class="nav-text">Performance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Heap-Sort"><span class="nav-text">Heap Sort</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Hybrid-sorts"><span class="nav-text">Hybrid sorts:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#IntroSort"><span class="nav-text">IntroSort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#An-example-5"><span class="nav-text">An example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#maxDepth-1-branch-less"><span class="nav-text">maxDepth: 1, branch: less</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#maxDepth-0-branch-less"><span class="nav-text">maxDepth: 0, branch: less</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#maxDepth-0-branch-greater"><span class="nav-text">maxDepth: 0, branch: greater</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#back-to-maxDepth-1-branch-greater"><span class="nav-text">back to maxDepth = 1, branch: greater</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Special-purpose-sorts"><span class="nav-text">Special-purpose sorts:</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Counting-Sort"><span class="nav-text">Counting Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Example"><span class="nav-text">Example</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-1"><span class="nav-text">Step 1:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-2"><span class="nav-text">Step 2:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-3"><span class="nav-text">Step 3:</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-3"><span class="nav-text">Performance</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Radix-Sort"><span class="nav-text">Radix Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Example-1"><span class="nav-text">Example</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-1-1"><span class="nav-text">Step 1:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Step-2-1"><span class="nav-text">Step 2:</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Algorithm-in-Action"><span class="nav-text">Algorithm in Action</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Topological-Sort"><span class="nav-text">Topological Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Where-is-this-used"><span class="nav-text">Where is this used?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#How-does-it-work"><span class="nav-text">How does it work?</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Example-2"><span class="nav-text">Example</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#The-code-2"><span class="nav-text">The code</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Kahn’s-algorithm"><span class="nav-text">Kahn’s algorithm</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Bad-sorting-algorithms-don’t-use-these"><span class="nav-text">Bad sorting algorithms (don’t use these!):</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Bubble-Sort"><span class="nav-text">Bubble Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Runtime"><span class="nav-text">Runtime:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Memory"><span class="nav-text">Memory:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Implementation"><span class="nav-text">Implementation:</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Example-3"><span class="nav-text">Example</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#First-Pass"><span class="nav-text">First Pass</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Second-Pass"><span class="nav-text">Second Pass</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Third-Pass"><span class="nav-text">Third Pass</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Code"><span class="nav-text">Code</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Optimization"><span class="nav-text">Optimization</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#First-Pass-1"><span class="nav-text">First Pass</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Second-Pass-1"><span class="nav-text">Second Pass</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Third-Pass-1"><span class="nav-text">Third Pass</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Fourth-Pass"><span class="nav-text">Fourth Pass</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Conclusion"><span class="nav-text">Conclusion</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Slow-Sort"><span class="nav-text">Slow Sort</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#The-code-3"><span class="nav-text">The code</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Performance-4"><span class="nav-text">Performance</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#See-also"><span class="nav-text">See also</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Reference"><span class="nav-text">Reference</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2020</span>
  <span class="with-love" id="heart">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Tuski</span>



  
</div>




  <div class="powered-by">Powered by </div>



  <span class="post-meta-divider">Perphet</span>


<!--

  <div class="theme-info">Theme &mdash;  v{}</div>




-->






        







        
      </div>
    </footer>

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  










  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>

  
  <script type="text/javascript" src="/lib/canvas-ribbon/canvas-ribbon.js"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	

		<script type="text/javascript">
		_hcwp = window._hcwp || [];

		_hcwp.push({widget:"Bloggerstream", widget_id: 99037, selector:".hc-comment-count", label: "{\%COUNT%\}" });

		
		_hcwp.push({widget:"Stream", widget_id: 99037, xid: "2019/06/Several-sorting-algorithms/"});
		

		(function() {
		if("HC_LOAD_INIT" in window)return;
		HC_LOAD_INIT = true;
		var lang = (navigator.language || navigator.systemLanguage || navigator.userLanguage || "en").substr(0, 2).toLowerCase();
		var hcc = document.createElement("script"); hcc.type = "text/javascript"; hcc.async = true;
		hcc.src = ("https:" == document.location.protocol ? "https" : "http")+"://w.hypercomments.com/widget/hc/99037/"+lang+"/widget.js";
		var s = document.getElementsByTagName("script")[0];
		s.parentNode.insertBefore(hcc, s.nextSibling);
		})();
		</script>

	












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.4.js"></script>
  <script>AV.initialize("c6sjJ6fGADGrCVC48k5MVQcD-gzGzoHsz", "YuTcQ8aPXftmtmeC4VvTrK9B");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  
  <script type="text/javascript">
  wpac_init = window.wpac_init || [];
  wpac_init.push({widget: 'Rating', id: 8566,
    el: 'wpac-rating',
    color: 'fc6423'
  });
  (function() {
    if ('WIDGETPACK_LOADED' in window) return;
    WIDGETPACK_LOADED = true;
    var mc = document.createElement('script');
    mc.type = 'text/javascript';
    mc.async = true;
    mc.src = '//embed.widgetpack.com/widget.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(mc, s.nextSibling);
  })();
  </script>


  

  

  

  
<div id="hexo-helper-live2d">
  <canvas id="live2dcanvas" width="150" height="350"></canvas>
</div>
<style>
  #live2dcanvas{
    position: fixed;
    width: 150px;
    height: 350px;
    opacity:0.8;
    right: 0px;
    z-index: 999;
    pointer-events: none;
    bottom: -20px;
  }
</style>
<script type="text/javascript" src="/live2d/device.min.js"></script>
<script type="text/javascript">
const loadScript = function loadScript(c,b){var a=document.createElement("script");a.type="text/javascript";"undefined"!=typeof b&&(a.readyState?a.onreadystatechange=function(){if("loaded"==a.readyState||"complete"==a.readyState)a.onreadystatechange=null,b()}:a.onload=function(){b()});a.src=c;document.body.appendChild(a)};
(function(){
  if((typeof(device) != 'undefined') && (device.mobile())){
    var trElement = document.getElementById('hexo-helper-live2d');
    trElement.parentNode.removeChild(trElement);
    return;
  }else
    if (typeof(device) === 'undefined') console.error('Cannot find current-device script.');
  loadScript("/live2d/script.js", function(){loadlive2d("live2dcanvas", "/live2d/assets/shizuku.model.json", 0.5);});
})();
</script>

 <canvas class="fireworks" 
        style="position: fixed; left: 0px; top: 0px; z-index: 99999999; pointer-events: none; width: 1158px; height: 916px;" 
        width="2316" 
        height="1832">
</canvas>
<script type="text/javascript" src="/js/src/anime.min.js"></script>
<script type="text/javascript" src="/js/src/fireworks.js"></script>
</body>
</html>
